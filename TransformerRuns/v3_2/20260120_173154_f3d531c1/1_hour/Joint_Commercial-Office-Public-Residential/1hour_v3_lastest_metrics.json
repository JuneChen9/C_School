{
  "model": "MultiBuildingMSPatchTST",
  "resolution": "1_hour",
  "buildings": [
    "Commercial",
    "Office",
    "Public",
    "Residential"
  ],
  "series_dir": "C:\\Users\\13470\\Desktop\\C_school\\AfterWash\\1_hour",
  "paper_figs_dir": "C:\\Users\\13470\\Desktop\\C_school\\TransformerRuns\\MultiBuildingMSPatchTST\\20260120_173154_f3d531c1\\1_hour\\Joint_Commercial-Office-Public-Residential\\paper_figs",
  "window": {
    "input_len": 168,
    "pred_len": 24
  },
  "patch_scales": [
    [
      12,
      6
    ],
    [
      24,
      12
    ]
  ],
  "model_cfg": {
    "d_model": 192,
    "n_heads": 8,
    "n_layers": 4,
    "d_ff": 384
  },
  "train_cfg": {
    "epochs": 30,
    "micro_batch": 32,
    "effective_batch": 32,
    "lr": 0.001,
    "weight_decay": 0.0001,
    "dropout": 0.1,
    "d_model": 256,
    "n_heads": 8,
    "n_layers": 6,
    "d_ff": 512,
    "huber_beta": 1.0,
    "total_loss_weight": 0.1,
    "residual_reg": 0.001,
    "fusion": "gated_residual",
    "gate_mode": "building",
    "gate_init": -2.0,
    "gate_max": 0.7,
    "gate_reg": 0.01,
    "grad_clip": 1.0,
    "patience": 6,
    "num_workers": 2,
    "save_every": 1,
    "grad_checkpoint": false,
    "auto_res_tune": true,
    "auto_quantiles": true
  },
  "best_val_loss_scaled": 17.724837901228565,
  "val_metrics": {
    "per_building": {
      "Commercial": {
        "MAE": 79.00363159179688,
        "RMSE": 106.74557495117188,
        "MAPE": 0.14766672253608704,
        "sMAPE": 0.15223796665668488,
        "MASE": 1.306880373245686,
        "R2": 0.7040637731552124,
        "NRMSE": 0.09817310471999169
      },
      "Office": {
        "MAE": 103.65494537353516,
        "RMSE": 186.115234375,
        "MAPE": 0.2540278732776642,
        "sMAPE": 0.227995365858078,
        "MASE": 0.9526347143069298,
        "R2": 0.7032312154769897,
        "NRMSE": 0.15809993382154547
      },
      "Public": {
        "MAE": 45.3225212097168,
        "RMSE": 65.7295150756836,
        "MAPE": 0.25863760709762573,
        "sMAPE": 0.2379363477230072,
        "MASE": 1.2864174076642194,
        "R2": 0.6115984320640564,
        "NRMSE": 0.12669527542288136
      },
      "Residential": {
        "MAE": 32.736602783203125,
        "RMSE": 45.398258209228516,
        "MAPE": 0.13626430928707123,
        "sMAPE": 0.144375279545784,
        "MASE": 1.279866610093279,
        "R2": 0.7388465404510498,
        "NRMSE": 0.07145618338194876
      }
    },
    "avg": {
      "MAE": 65.17942523956299,
      "RMSE": 100.997145652771,
      "MAPE": 0.19914912804961205,
      "sMAPE": 0.19063623994588852,
      "MASE": 1.2064497763275286,
      "R2": 0.6894349902868271,
      "NRMSE": 0.11360612433659183
    },
    "total": {
      "MAE": 177.35305786132812,
      "RMSE": 250.2068328857422,
      "MAPE": 0.12630809843540192,
      "sMAPE": 0.1266990303993225,
      "R2": 0.7676414847373962,
      "NRMSE": 0.10770897000577827
    }
  },
  "test_metrics": {
    "per_building": {
      "Commercial": {
        "MAE": 104.2826156616211,
        "RMSE": 153.57615661621094,
        "MAPE": 0.14393512904644012,
        "sMAPE": 0.14053407311439514,
        "MASE": 1.7250460634906633,
        "R2": 0.673005223274231,
        "NRMSE": 0.09229169781335228
      },
      "Office": {
        "MAE": 81.21710968017578,
        "RMSE": 127.58761596679688,
        "MAPE": 0.25024256110191345,
        "sMAPE": 0.24259990453720093,
        "MASE": 0.7464210974034506,
        "R2": 0.8081414103507996,
        "NRMSE": 0.101501683346696
      },
      "Public": {
        "MAE": 47.13310241699219,
        "RMSE": 63.780433654785156,
        "MAPE": 0.25048714876174927,
        "sMAPE": 0.24175694584846497,
        "MASE": 1.3378082641492601,
        "R2": 0.7922850847244263,
        "NRMSE": 0.09885373907017123
      },
      "Residential": {
        "MAE": 43.50432586669922,
        "RMSE": 66.2687759399414,
        "MAPE": 0.14764069020748138,
        "sMAPE": 0.13928352296352386,
        "MASE": 1.7008403236017662,
        "R2": 0.5161179900169373,
        "NRMSE": 0.12517713049463378
      }
    },
    "avg": {
      "MAE": 69.03428840637207,
      "RMSE": 102.8032455444336,
      "MAPE": 0.19807638227939606,
      "sMAPE": 0.19104361161589622,
      "MASE": 1.3775289371612849,
      "R2": 0.6973874270915985,
      "NRMSE": 0.10445606268121332
    },
    "total": {
      "MAE": 186.42376708984375,
      "RMSE": 252.94668579101562,
      "MAPE": 0.11923730373382568,
      "sMAPE": 0.11522506177425385,
      "R2": 0.7892933487892151,
      "NRMSE": 0.08907201323610578
    }
  },
  "baseline_mode": "weekly",
  "fusion": "gated_residual",
  "gate_mode": "building",
  "gate_max": 0.7,
  "gate_reg": 0.01,
  "residual_reg": 0.001,
  "total_loss_weight": 0.1,
  "huber_beta": 1.0,
  "baseline_val_metrics": {
    "per_building": {
      "Commercial": {
        "MAE": 111.45233917236328,
        "RMSE": 153.05096435546875,
        "MAPE": 0.20167870819568634,
        "sMAPE": 0.19683660566806793,
        "MASE": 1.843647838485017,
        "R2": 0.3916260004043579,
        "NRMSE": 0.14075982407737453
      },
      "Office": {
        "MAE": 103.45787811279297,
        "RMSE": 209.26585388183594,
        "MAPE": 0.23334477841854095,
        "sMAPE": 0.1892213225364685,
        "MASE": 0.9508235791704455,
        "R2": 0.6248102188110352,
        "NRMSE": 0.17776576840112562
      },
      "Public": {
        "MAE": 54.889739990234375,
        "RMSE": 85.4296646118164,
        "MAPE": 0.29057207703590393,
        "sMAPE": 0.26237934827804565,
        "MASE": 1.5579697497159948,
        "R2": 0.3438887596130371,
        "NRMSE": 0.16466780372281478
      },
      "Residential": {
        "MAE": 39.657981872558594,
        "RMSE": 55.80607986450195,
        "MAPE": 0.15442481637001038,
        "sMAPE": 0.156887948513031,
        "MASE": 1.5504640832314838,
        "R2": 0.6053788065910339,
        "NRMSE": 0.087837939910543
      }
    },
    "avg": {
      "MAE": 77.3644847869873,
      "RMSE": 125.88814067840576,
      "MAPE": 0.2200050950050354,
      "sMAPE": 0.20133130624890327,
      "MASE": 1.4757263126507352,
      "R2": 0.49142594635486603,
      "NRMSE": 0.1427578340279645
    },
    "total": {
      "MAE": 266.4501953125,
      "RMSE": 386.8438720703125,
      "MAPE": 0.18507583439350128,
      "sMAPE": 0.17682527005672455,
      "R2": 0.4445670247077942,
      "NRMSE": 0.16652844581893408
    }
  },
  "baseline_test_metrics": {
    "per_building": {
      "Commercial": {
        "MAE": 129.20828247070312,
        "RMSE": 191.70082092285156,
        "MAPE": 0.1757652759552002,
        "sMAPE": 0.17045184969902039,
        "MASE": 2.137367169324905,
        "R2": 0.49050360918045044,
        "NRMSE": 0.11520274126534452
      },
      "Office": {
        "MAE": 70.4913558959961,
        "RMSE": 133.82403564453125,
        "MAPE": 0.18305425345897675,
        "sMAPE": 0.1674814075231552,
        "MASE": 0.6478466844307027,
        "R2": 0.7889271378517151,
        "NRMSE": 0.10646303551673131
      },
      "Public": {
        "MAE": 48.47207260131836,
        "RMSE": 73.05413818359375,
        "MAPE": 0.21872375905513763,
        "sMAPE": 0.20748980343341827,
        "MASE": 1.3758130906126933,
        "R2": 0.7274900674819946,
        "NRMSE": 0.1132271184151066
      },
      "Residential": {
        "MAE": 54.95962142944336,
        "RMSE": 82.48458099365234,
        "MAPE": 0.18015389144420624,
        "sMAPE": 0.16966180503368378,
        "MASE": 2.148695294888783,
        "R2": 0.2503352165222168,
        "NRMSE": 0.1558076637509526
      }
    },
    "avg": {
      "MAE": 75.78283309936523,
      "RMSE": 120.26589393615723,
      "MAPE": 0.1894242949783802,
      "sMAPE": 0.1787712164223194,
      "MASE": 1.577430559814271,
      "R2": 0.5643140077590942,
      "NRMSE": 0.12267513973703376
    },
    "total": {
      "MAE": 258.0083312988281,
      "RMSE": 355.2920227050781,
      "MAPE": 0.15725548565387726,
      "sMAPE": 0.15298296511173248,
      "R2": 0.5842893123626709,
      "NRMSE": 0.12511164417950071
    }
  },
  "micro_batch": 32,
  "effective_batch": 32,
  "accum_steps": 1,
  "clip_nonneg": true,
  "exports": {
    "test": {
      "npz": "C:\\Users\\13470\\Desktop\\C_school\\TransformerRuns\\MultiBuildingMSPatchTST\\20260120_173154_f3d531c1\\1_hour\\Joint_Commercial-Office-Public-Residential\\preds\\test\\test_samples.npz",
      "plots_dir": "C:\\Users\\13470\\Desktop\\C_school\\TransformerRuns\\MultiBuildingMSPatchTST\\20260120_173154_f3d531c1\\1_hour\\Joint_Commercial-Office-Public-Residential\\preds\\test\\plots",
      "export_k": 64,
      "plot_k": 12,
      "strategy": "uniform"
    }
  },
  "explain": {
    "dir": "C:\\Users\\13470\\Desktop\\C_school\\TransformerRuns\\MultiBuildingMSPatchTST\\20260120_173154_f3d531c1\\1_hour\\Joint_Commercial-Office-Public-Residential\\explain"
  },
  "timestamp": "2026-01-20 17:35:40"
}