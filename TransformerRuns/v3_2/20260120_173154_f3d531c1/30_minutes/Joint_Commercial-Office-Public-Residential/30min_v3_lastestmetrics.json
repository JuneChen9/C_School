{
  "model": "MultiBuildingMSPatchTST",
  "resolution": "30_minutes",
  "buildings": [
    "Commercial",
    "Office",
    "Public",
    "Residential"
  ],
  "series_dir": "C:\\Users\\13470\\Desktop\\C_school\\AfterWash\\30_minutes",
  "paper_figs_dir": "C:\\Users\\13470\\Desktop\\C_school\\TransformerRuns\\MultiBuildingMSPatchTST\\20260120_173154_f3d531c1\\30_minutes\\Joint_Commercial-Office-Public-Residential\\paper_figs",
  "window": {
    "input_len": 336,
    "pred_len": 48
  },
  "patch_scales": [
    [
      24,
      12
    ],
    [
      48,
      24
    ]
  ],
  "model_cfg": {
    "d_model": 192,
    "n_heads": 8,
    "n_layers": 4,
    "d_ff": 384
  },
  "train_cfg": {
    "epochs": 30,
    "micro_batch": 32,
    "effective_batch": 32,
    "lr": 0.001,
    "weight_decay": 0.0001,
    "dropout": 0.1,
    "d_model": 256,
    "n_heads": 8,
    "n_layers": 6,
    "d_ff": 512,
    "huber_beta": 1.0,
    "total_loss_weight": 0.1,
    "residual_reg": 0.001,
    "fusion": "gated_residual",
    "gate_mode": "building",
    "gate_init": -2.0,
    "gate_max": 0.7,
    "gate_reg": 0.01,
    "grad_clip": 1.0,
    "patience": 6,
    "num_workers": 2,
    "save_every": 1,
    "grad_checkpoint": false,
    "auto_res_tune": true,
    "auto_quantiles": true
  },
  "best_val_loss_scaled": 16.392363544237817,
  "val_metrics": {
    "per_building": {
      "Commercial": {
        "MAE": 85.8182144165039,
        "RMSE": 115.91680908203125,
        "MAPE": 0.16018244624137878,
        "sMAPE": 0.17096221446990967,
        "MASE": 1.3975378512919134,
        "R2": 0.6531022787094116,
        "NRMSE": 0.10143227522688435
      },
      "Office": {
        "MAE": 89.44037628173828,
        "RMSE": 159.52215576171875,
        "MAPE": 0.21074911952018738,
        "sMAPE": 0.18265458941459656,
        "MASE": 0.8368093409822419,
        "R2": 0.7803468704223633,
        "NRMSE": 0.13550982193205002
      },
      "Public": {
        "MAE": 44.6597900390625,
        "RMSE": 64.33467102050781,
        "MAPE": 0.24953565001487732,
        "sMAPE": 0.23399628698825836,
        "MASE": 1.277851090179056,
        "R2": 0.6319369077682495,
        "NRMSE": 0.11800196181227839
      },
      "Residential": {
        "MAE": 36.44694137573242,
        "RMSE": 50.588199615478516,
        "MAPE": 0.14976423978805542,
        "sMAPE": 0.16231469810009003,
        "MASE": 1.4226376551840074,
        "R2": 0.677157998085022,
        "NRMSE": 0.07962507398469841
      }
    },
    "avg": {
      "MAE": 64.09133052825928,
      "RMSE": 97.59045886993408,
      "MAPE": 0.19255786389112473,
      "sMAPE": 0.18748194724321365,
      "MASE": 1.2337089844093048,
      "R2": 0.6856360137462616,
      "NRMSE": 0.1086422832389778
    },
    "total": {
      "MAE": 163.04769897460938,
      "RMSE": 220.10813903808594,
      "MAPE": 0.1101304441690445,
      "sMAPE": 0.10899318009614944,
      "R2": 0.8211398124694824,
      "NRMSE": 0.09475209238792866
    }
  },
  "test_metrics": {
    "per_building": {
      "Commercial": {
        "MAE": 98.47843933105469,
        "RMSE": 139.5823211669922,
        "MAPE": 0.13367010653018951,
        "sMAPE": 0.1316947489976883,
        "MASE": 1.6037078775998836,
        "R2": 0.7362059354782104,
        "NRMSE": 0.08370955504500752
      },
      "Office": {
        "MAE": 71.83179473876953,
        "RMSE": 119.58216094970703,
        "MAPE": 0.20961859822273254,
        "sMAPE": 0.19598300755023956,
        "MASE": 0.6720624321567665,
        "R2": 0.8319211006164551,
        "NRMSE": 0.0922018909999872
      },
      "Public": {
        "MAE": 48.921382904052734,
        "RMSE": 70.5527572631836,
        "MAPE": 0.2381039708852768,
        "sMAPE": 0.22734834253787994,
        "MASE": 1.3997880962344786,
        "R2": 0.7390503883361816,
        "NRMSE": 0.10935022102069103
      },
      "Residential": {
        "MAE": 48.012840270996094,
        "RMSE": 71.49916076660156,
        "MAPE": 0.16223327815532684,
        "sMAPE": 0.15330810844898224,
        "MASE": 1.8740907171797359,
        "R2": 0.43061691522598267,
        "NRMSE": 0.13071144564278164
      }
    },
    "avg": {
      "MAE": 66.81111431121826,
      "RMSE": 100.3041000366211,
      "MAPE": 0.18590648844838142,
      "sMAPE": 0.1770835518836975,
      "MASE": 1.387412280792716,
      "R2": 0.6844485849142075,
      "NRMSE": 0.10399327817711684
    },
    "total": {
      "MAE": 176.21786499023438,
      "RMSE": 249.1949005126953,
      "MAPE": 0.10785408318042755,
      "sMAPE": 0.1049766093492508,
      "R2": 0.797842264175415,
      "NRMSE": 0.08752741174475086
    }
  },
  "baseline_mode": "weekly",
  "fusion": "gated_residual",
  "gate_mode": "building",
  "gate_max": 0.7,
  "gate_reg": 0.01,
  "residual_reg": 0.001,
  "total_loss_weight": 0.1,
  "huber_beta": 1.0,
  "baseline_val_metrics": {
    "per_building": {
      "Commercial": {
        "MAE": 109.87394714355469,
        "RMSE": 150.3970184326172,
        "MAPE": 0.19903114438056946,
        "sMAPE": 0.19414891302585602,
        "MASE": 1.7892821593644639,
        "R2": 0.4160346984863281,
        "NRMSE": 0.13160396570409721
      },
      "Office": {
        "MAE": 98.60013580322266,
        "RMSE": 202.760986328125,
        "MAPE": 0.2233591079711914,
        "sMAPE": 0.18128985166549683,
        "MASE": 0.9225085816091417,
        "R2": 0.6451342105865479,
        "NRMSE": 0.17224005669239215
      },
      "Public": {
        "MAE": 54.8112678527832,
        "RMSE": 84.65929412841797,
        "MAPE": 0.28761252760887146,
        "sMAPE": 0.2613063454627991,
        "MASE": 1.5683154425605885,
        "R2": 0.3626450300216675,
        "NRMSE": 0.15528116697156258
      },
      "Residential": {
        "MAE": 39.23930740356445,
        "RMSE": 55.44549560546875,
        "MAPE": 0.1515941321849823,
        "sMAPE": 0.15449701249599457,
        "MASE": 1.5316323995521997,
        "R2": 0.6121854782104492,
        "NRMSE": 0.08727038564845277
      }
    },
    "avg": {
      "MAE": 75.63116455078125,
      "RMSE": 123.31569862365723,
      "MAPE": 0.21539922803640366,
      "sMAPE": 0.19781053066253662,
      "MASE": 1.4529346457715984,
      "R2": 0.5089998543262482,
      "NRMSE": 0.13659889375412618
    },
    "total": {
      "MAE": 262.0980224609375,
      "RMSE": 380.8123779296875,
      "MAPE": 0.18239788711071014,
      "sMAPE": 0.17431163787841797,
      "R2": 0.4646182060241699,
      "NRMSE": 0.16393200984638306
    }
  },
  "baseline_test_metrics": {
    "per_building": {
      "Commercial": {
        "MAE": 121.20899200439453,
        "RMSE": 175.35386657714844,
        "MAPE": 0.16380932927131653,
        "sMAPE": 0.1603318154811859,
        "MASE": 1.9738718102541137,
        "R2": 0.5836727619171143,
        "NRMSE": 0.10516227287145792
      },
      "Office": {
        "MAE": 70.33576202392578,
        "RMSE": 133.5695037841797,
        "MAPE": 0.18307894468307495,
        "sMAPE": 0.16800659894943237,
        "MASE": 0.6580654634247389,
        "R2": 0.7903016805648804,
        "NRMSE": 0.10298660545205246
      },
      "Public": {
        "MAE": 51.03562545776367,
        "RMSE": 77.55400085449219,
        "MAPE": 0.2256796807050705,
        "sMAPE": 0.21402768790721893,
        "MASE": 1.4602829429366102,
        "R2": 0.6846904754638672,
        "NRMSE": 0.12020149833184435
      },
      "Residential": {
        "MAE": 54.538299560546875,
        "RMSE": 82.06520080566406,
        "MAPE": 0.17881210148334503,
        "sMAPE": 0.16862158477306366,
        "MASE": 2.1287997202475872,
        "R2": 0.24989724159240723,
        "NRMSE": 0.1500277894070641
      }
    },
    "avg": {
      "MAE": 74.27966976165771,
      "RMSE": 117.1356430053711,
      "MAPE": 0.18784501403570175,
      "sMAPE": 0.17774692177772522,
      "MASE": 1.5552549842157624,
      "R2": 0.5771405398845673,
      "NRMSE": 0.1195945415156047
    },
    "total": {
      "MAE": 254.15159606933594,
      "RMSE": 348.0463562011719,
      "MAPE": 0.15460485219955444,
      "sMAPE": 0.15090817213058472,
      "R2": 0.6056458950042725,
      "NRMSE": 0.12224807434985296
    }
  },
  "micro_batch": 32,
  "effective_batch": 32,
  "accum_steps": 1,
  "clip_nonneg": true,
  "exports": {
    "test": {
      "npz": "C:\\Users\\13470\\Desktop\\C_school\\TransformerRuns\\MultiBuildingMSPatchTST\\20260120_173154_f3d531c1\\30_minutes\\Joint_Commercial-Office-Public-Residential\\preds\\test\\test_samples.npz",
      "plots_dir": "C:\\Users\\13470\\Desktop\\C_school\\TransformerRuns\\MultiBuildingMSPatchTST\\20260120_173154_f3d531c1\\30_minutes\\Joint_Commercial-Office-Public-Residential\\preds\\test\\plots",
      "export_k": 64,
      "plot_k": 12,
      "strategy": "uniform"
    }
  },
  "explain": {
    "dir": "C:\\Users\\13470\\Desktop\\C_school\\TransformerRuns\\MultiBuildingMSPatchTST\\20260120_173154_f3d531c1\\30_minutes\\Joint_Commercial-Office-Public-Residential\\explain"
  },
  "timestamp": "2026-01-20 17:44:01"
}