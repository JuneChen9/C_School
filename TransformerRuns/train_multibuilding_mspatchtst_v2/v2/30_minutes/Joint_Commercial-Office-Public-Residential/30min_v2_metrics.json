{
  "model": "MultiBuildingMSPatchTST",
  "resolution": "30_minutes",
  "buildings": [
    "Commercial",
    "Office",
    "Public",
    "Residential"
  ],
  "series_dir": "C:\\Users\\13470\\Desktop\\C_school\\AfterWash\\30_minutes",
  "window": {
    "input_len": 336,
    "pred_len": 48
  },
  "patch_scales": [
    [
      24,
      12
    ],
    [
      48,
      24
    ]
  ],
  "model_cfg": {
    "d_model": 192,
    "n_heads": 8,
    "n_layers": 4,
    "d_ff": 384
  },
  "train_cfg": {
    "epochs": 30,
    "micro_batch": 32,
    "effective_batch": 32,
    "lr": 0.001,
    "weight_decay": 0.0001,
    "dropout": 0.1,
    "d_model": 256,
    "n_heads": 8,
    "n_layers": 6,
    "d_ff": 512,
    "huber_beta": 1.0,
    "total_loss_weight": 0.1,
    "residual_reg": 0.001,
    "fusion": "gated_residual",
    "gate_mode": "building",
    "gate_init": -2.0,
    "gate_max": 0.7,
    "gate_reg": 0.01,
    "grad_clip": 1.0,
    "patience": 6,
    "num_workers": 2,
    "save_every": 1,
    "grad_checkpoint": false,
    "auto_res_tune": true,
    "auto_quantiles": true
  },
  "best_val_loss_scaled": 26.420519256591795,
  "val_metrics": {
    "per_building": {
      "Commercial": {
        "MAE": 111.5107650756836,
        "RMSE": 152.6792755126953,
        "MAPE": 0.2051062434911728,
        "sMAPE": 0.19685056805610657,
        "MASE": 1.8159375148898242,
        "R2": 0.3981770873069763,
        "NRMSE": 0.133601040417577
      },
      "Office": {
        "MAE": 117.17208099365234,
        "RMSE": 208.56224060058594,
        "MAPE": 0.28620681166648865,
        "sMAPE": 0.23615425825119019,
        "MASE": 1.096268776519401,
        "R2": 0.6245373487472534,
        "NRMSE": 0.17716806766171467
      },
      "Public": {
        "MAE": 56.289947509765625,
        "RMSE": 86.17183685302734,
        "MAPE": 0.3052850067615509,
        "sMAPE": 0.27077701687812805,
        "MASE": 1.610624920729829,
        "R2": 0.33966726064682007,
        "NRMSE": 0.15805545657307307
      },
      "Residential": {
        "MAE": 37.79851531982422,
        "RMSE": 52.6497917175293,
        "MAPE": 0.14984148740768433,
        "sMAPE": 0.14981377124786377,
        "MASE": 1.475393796414306,
        "R2": 0.6503086686134338,
        "NRMSE": 0.08286998929893777
      }
    },
    "avg": {
      "MAE": 80.69282722473145,
      "RMSE": 125.01578617095947,
      "MAPE": 0.23660988733172417,
      "sMAPE": 0.21339890360832214,
      "MASE": 1.49955625213834,
      "R2": 0.5031725913286209,
      "NRMSE": 0.13792363848782563
    },
    "total": {
      "MAE": 266.6885986328125,
      "RMSE": 387.2154846191406,
      "MAPE": 0.19097286462783813,
      "sMAPE": 0.17745423316955566,
      "R2": 0.4464626908302307,
      "NRMSE": 0.1666884174888276
    }
  },
  "test_metrics": {
    "per_building": {
      "Commercial": {
        "MAE": 119.36238861083984,
        "RMSE": 174.19972229003906,
        "MAPE": 0.15919657051563263,
        "sMAPE": 0.15860648453235626,
        "MASE": 1.943800127262764,
        "R2": 0.5891351699829102,
        "NRMSE": 0.10447011569908882
      },
      "Office": {
        "MAE": 81.64321899414062,
        "RMSE": 136.46270751953125,
        "MAPE": 0.21657001972198486,
        "sMAPE": 0.2165198177099228,
        "MASE": 0.7638586857790874,
        "R2": 0.7811188697814941,
        "NRMSE": 0.10521736339562092
      },
      "Public": {
        "MAE": 51.332672119140625,
        "RMSE": 76.37122344970703,
        "MAPE": 0.226673886179924,
        "sMAPE": 0.22867931425571442,
        "MASE": 1.4687823425025863,
        "R2": 0.6942347288131714,
        "NRMSE": 0.11836830320739203
      },
      "Residential": {
        "MAE": 54.783443450927734,
        "RMSE": 83.30602264404297,
        "MAPE": 0.1795463114976883,
        "sMAPE": 0.17098145186901093,
        "MASE": 2.138368449919546,
        "R2": 0.2270427942276001,
        "NRMSE": 0.1522962022743016
      }
    },
    "avg": {
      "MAE": 76.7804307937622,
      "RMSE": 117.58491897583008,
      "MAPE": 0.19549669697880745,
      "sMAPE": 0.1936967670917511,
      "MASE": 1.578702401365996,
      "R2": 0.572882890701294,
      "NRMSE": 0.12008799614410084
    },
    "total": {
      "MAE": 257.3224182128906,
      "RMSE": 350.870361328125,
      "MAPE": 0.1521550714969635,
      "sMAPE": 0.15305130183696747,
      "R2": 0.5992205142974854,
      "NRMSE": 0.12323998011922292
    }
  },
  "baseline_mode": "weekly",
  "fusion": "gated_residual",
  "gate_mode": "building",
  "gate_max": 0.7,
  "gate_reg": 0.01,
  "residual_reg": 0.001,
  "total_loss_weight": 0.1,
  "huber_beta": 1.0,
  "baseline_val_metrics": {
    "per_building": {
      "Commercial": {
        "MAE": 109.87394714355469,
        "RMSE": 150.3970184326172,
        "MAPE": 0.19903114438056946,
        "sMAPE": 0.19414891302585602,
        "MASE": 1.7892821593644639,
        "R2": 0.4160346984863281,
        "NRMSE": 0.13160396570409721
      },
      "Office": {
        "MAE": 98.60013580322266,
        "RMSE": 202.760986328125,
        "MAPE": 0.2233591079711914,
        "sMAPE": 0.18128985166549683,
        "MASE": 0.9225085816091417,
        "R2": 0.6451342105865479,
        "NRMSE": 0.17224005669239215
      },
      "Public": {
        "MAE": 54.8112678527832,
        "RMSE": 84.65929412841797,
        "MAPE": 0.28761252760887146,
        "sMAPE": 0.2613063454627991,
        "MASE": 1.5683154425605885,
        "R2": 0.3626450300216675,
        "NRMSE": 0.15528116697156258
      },
      "Residential": {
        "MAE": 39.23930740356445,
        "RMSE": 55.44549560546875,
        "MAPE": 0.1515941321849823,
        "sMAPE": 0.15449701249599457,
        "MASE": 1.5316323995521997,
        "R2": 0.6121854782104492,
        "NRMSE": 0.08727038564845277
      }
    },
    "avg": {
      "MAE": 75.63116455078125,
      "RMSE": 123.31569862365723,
      "MAPE": 0.21539922803640366,
      "sMAPE": 0.19781053066253662,
      "MASE": 1.4529346457715984,
      "R2": 0.5089998543262482,
      "NRMSE": 0.13659889375412618
    },
    "total": {
      "MAE": 262.0980224609375,
      "RMSE": 380.8123779296875,
      "MAPE": 0.18239788711071014,
      "sMAPE": 0.17431163787841797,
      "R2": 0.4646182060241699,
      "NRMSE": 0.16393200984638306
    }
  },
  "baseline_test_metrics": {
    "per_building": {
      "Commercial": {
        "MAE": 121.20899200439453,
        "RMSE": 175.35386657714844,
        "MAPE": 0.16380932927131653,
        "sMAPE": 0.1603318154811859,
        "MASE": 1.9738718102541137,
        "R2": 0.5836727619171143,
        "NRMSE": 0.10516227287145792
      },
      "Office": {
        "MAE": 70.33576202392578,
        "RMSE": 133.5695037841797,
        "MAPE": 0.18307894468307495,
        "sMAPE": 0.16800659894943237,
        "MASE": 0.6580654634247389,
        "R2": 0.7903016805648804,
        "NRMSE": 0.10298660545205246
      },
      "Public": {
        "MAE": 51.03562545776367,
        "RMSE": 77.55400085449219,
        "MAPE": 0.2256796807050705,
        "sMAPE": 0.21402768790721893,
        "MASE": 1.4602829429366102,
        "R2": 0.6846904754638672,
        "NRMSE": 0.12020149833184435
      },
      "Residential": {
        "MAE": 54.538299560546875,
        "RMSE": 82.06520080566406,
        "MAPE": 0.17881210148334503,
        "sMAPE": 0.16862158477306366,
        "MASE": 2.1287997202475872,
        "R2": 0.24989724159240723,
        "NRMSE": 0.1500277894070641
      }
    },
    "avg": {
      "MAE": 74.27966976165771,
      "RMSE": 117.1356430053711,
      "MAPE": 0.18784501403570175,
      "sMAPE": 0.17774692177772522,
      "MASE": 1.5552549842157624,
      "R2": 0.5771405398845673,
      "NRMSE": 0.1195945415156047
    },
    "total": {
      "MAE": 254.15159606933594,
      "RMSE": 348.0463562011719,
      "MAPE": 0.15460485219955444,
      "sMAPE": 0.15090817213058472,
      "R2": 0.6056458950042725,
      "NRMSE": 0.12224807434985296
    }
  },
  "micro_batch": 512,
  "effective_batch": 32,
  "accum_steps": 1,
  "clip_nonneg": false,
  "exports": {
    "test": {
      "npz": "C:\\Users\\13470\\Desktop\\C_school\\TransformerRuns\\MultiBuildingMSPatchTST\\20260119_135326_3c1e6694\\30_minutes\\Joint_Commercial-Office-Public-Residential\\preds\\test_samples.npz",
      "plots_dir": "C:\\Users\\13470\\Desktop\\C_school\\TransformerRuns\\MultiBuildingMSPatchTST\\20260119_135326_3c1e6694\\30_minutes\\Joint_Commercial-Office-Public-Residential\\preds\\plots",
      "export_k": 64,
      "plot_k": 12,
      "strategy": "uniform"
    }
  },
  "explain": {},
  "timestamp": "2026-01-19 13:55:06"
}