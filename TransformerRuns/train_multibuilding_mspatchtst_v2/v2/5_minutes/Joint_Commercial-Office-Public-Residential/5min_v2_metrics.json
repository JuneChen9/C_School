{
  "model": "MultiBuildingMSPatchTST",
  "resolution": "5_minutes",
  "buildings": [
    "Commercial",
    "Office",
    "Public",
    "Residential"
  ],
  "series_dir": "C:\\Users\\13470\\Desktop\\C_school\\AfterWash\\5_minutes",
  "window": {
    "input_len": 2016,
    "pred_len": 288
  },
  "patch_scales": [
    [
      32,
      16
    ],
    [
      64,
      32
    ]
  ],
  "model_cfg": {
    "d_model": 256,
    "n_heads": 8,
    "n_layers": 6,
    "d_ff": 512
  },
  "train_cfg": {
    "epochs": 30,
    "micro_batch": 32,
    "effective_batch": 32,
    "lr": 0.001,
    "weight_decay": 0.0001,
    "dropout": 0.1,
    "d_model": 256,
    "n_heads": 8,
    "n_layers": 6,
    "d_ff": 512,
    "huber_beta": 1.0,
    "total_loss_weight": 0.1,
    "residual_reg": 0.001,
    "fusion": "gated_residual",
    "gate_mode": "building",
    "gate_init": -2.0,
    "gate_max": 0.7,
    "gate_reg": 0.01,
    "grad_clip": 1.0,
    "patience": 6,
    "num_workers": 2,
    "save_every": 1,
    "grad_checkpoint": false,
    "auto_res_tune": true,
    "auto_quantiles": true
  },
  "best_val_loss_scaled": 26.787880458615042,
  "val_metrics": {
    "per_building": {
      "Commercial": {
        "MAE": 122.21865844726562,
        "RMSE": 172.576416015625,
        "MAPE": 0.23194043338298798,
        "sMAPE": 0.2211194783449173,
        "MASE": 1.9474668982960288,
        "R2": 0.22996199131011963,
        "NRMSE": 0.15101190815715496
      },
      "Office": {
        "MAE": 104.74539184570312,
        "RMSE": 202.8030242919922,
        "MAPE": 0.25542762875556946,
        "sMAPE": 0.20265109837055206,
        "MASE": 0.9785228263748382,
        "R2": 0.6447687149047852,
        "NRMSE": 0.16660342682951532
      },
      "Public": {
        "MAE": 57.21406173706055,
        "RMSE": 89.141845703125,
        "MAPE": 0.311825156211853,
        "sMAPE": 0.2868792712688446,
        "MASE": 1.627034155699411,
        "R2": 0.276273250579834,
        "NRMSE": 0.15519122895939527
      },
      "Residential": {
        "MAE": 42.5173225402832,
        "RMSE": 57.9776611328125,
        "MAPE": 0.17665697634220123,
        "sMAPE": 0.17859932780265808,
        "MASE": 1.6644084121932898,
        "R2": 0.5723962187767029,
        "NRMSE": 0.08570238157104583
      }
    },
    "avg": {
      "MAE": 81.67385864257812,
      "RMSE": 130.62473678588867,
      "MAPE": 0.24396254867315292,
      "sMAPE": 0.222312293946743,
      "MASE": 1.554358073140892,
      "R2": 0.4308500438928604,
      "NRMSE": 0.13962723637927785
    },
    "total": {
      "MAE": 266.98004150390625,
      "RMSE": 406.83282470703125,
      "MAPE": 0.1930847465991974,
      "sMAPE": 0.17778722941875458,
      "R2": 0.38949793577194214,
      "NRMSE": 0.16856689427687546
    }
  },
  "test_metrics": {
    "per_building": {
      "Commercial": {
        "MAE": 124.88282012939453,
        "RMSE": 174.55601501464844,
        "MAPE": 0.2348206341266632,
        "sMAPE": 0.16758783161640167,
        "MASE": 1.9899184090029098,
        "R2": 0.5892629623413086,
        "NRMSE": 0.09082707663558881
      },
      "Office": {
        "MAE": 72.26274871826172,
        "RMSE": 125.94062042236328,
        "MAPE": 0.20033468306064606,
        "sMAPE": 0.17882581055164337,
        "MASE": 0.6750726487478301,
        "R2": 0.8106773495674133,
        "NRMSE": 0.0948233688758974
      },
      "Public": {
        "MAE": 49.90774154663086,
        "RMSE": 70.778564453125,
        "MAPE": 0.23896461725234985,
        "sMAPE": 0.22127513587474823,
        "MASE": 1.4192594908462586,
        "R2": 0.7399793863296509,
        "NRMSE": 0.10414739110621823
      },
      "Residential": {
        "MAE": 54.3184700012207,
        "RMSE": 81.65890502929688,
        "MAPE": 0.18223078548908234,
        "sMAPE": 0.17362791299819946,
        "MASE": 2.1263831541095533,
        "R2": 0.2581384778022766,
        "NRMSE": 0.1402110261095057
      }
    },
    "avg": {
      "MAE": 75.34294509887695,
      "RMSE": 113.2335262298584,
      "MAPE": 0.21408767998218536,
      "sMAPE": 0.18532917276024818,
      "MASE": 1.5526584256766378,
      "R2": 0.5995145440101624,
      "NRMSE": 0.10750221568180253
    },
    "total": {
      "MAE": 236.9400634765625,
      "RMSE": 325.92413330078125,
      "MAPE": 0.14334431290626526,
      "sMAPE": 0.13949482142925262,
      "R2": 0.652851939201355,
      "NRMSE": 0.11298057474318851
    }
  },
  "baseline_mode": "weekly",
  "fusion": "gated_residual",
  "gate_mode": "building",
  "gate_max": 0.7,
  "gate_reg": 0.01,
  "residual_reg": 0.001,
  "total_loss_weight": 0.1,
  "huber_beta": 1.0,
  "baseline_val_metrics": {
    "per_building": {
      "Commercial": {
        "MAE": 108.2773666381836,
        "RMSE": 148.58396911621094,
        "MAPE": 0.1966618001461029,
        "sMAPE": 0.19177857041358948,
        "MASE": 1.7253223856446527,
        "R2": 0.4291878342628479,
        "NRMSE": 0.1300174682951538
      },
      "Office": {
        "MAE": 100.67927551269531,
        "RMSE": 206.70138549804688,
        "MAPE": 0.22917819023132324,
        "sMAPE": 0.1852828413248062,
        "MASE": 0.9405375023769604,
        "R2": 0.6309806704521179,
        "NRMSE": 0.16980594483049366
      },
      "Public": {
        "MAE": 54.4230842590332,
        "RMSE": 84.69024658203125,
        "MAPE": 0.2869228720664978,
        "sMAPE": 0.25967371463775635,
        "MASE": 1.547665281218737,
        "R2": 0.3467519283294678,
        "NRMSE": 0.14744123081892727
      },
      "Residential": {
        "MAE": 39.08098220825195,
        "RMSE": 55.3955078125,
        "MAPE": 0.15102237462997437,
        "sMAPE": 0.15389877557754517,
        "MASE": 1.5298873884300235,
        "R2": 0.6096364259719849,
        "NRMSE": 0.08188545131189948
      }
    },
    "avg": {
      "MAE": 75.61517715454102,
      "RMSE": 123.84277725219727,
      "MAPE": 0.21594630926847458,
      "sMAPE": 0.1976584754884243,
      "MASE": 1.4358531394175935,
      "R2": 0.5041392147541046,
      "NRMSE": 0.13228752381411854
    },
    "total": {
      "MAE": 262.6336975097656,
      "RMSE": 382.3007507324219,
      "MAPE": 0.18317990005016327,
      "sMAPE": 0.17478585243225098,
      "R2": 0.4609047770500183,
      "NRMSE": 0.15840228791049296
    }
  },
  "baseline_test_metrics": {
    "per_building": {
      "Commercial": {
        "MAE": 124.09662628173828,
        "RMSE": 178.041015625,
        "MAPE": 0.2538420259952545,
        "sMAPE": 0.16541126370429993,
        "MASE": 1.9773909724117515,
        "R2": 0.5726985931396484,
        "NRMSE": 0.09264043389792613
      },
      "Office": {
        "MAE": 71.02643585205078,
        "RMSE": 133.6939697265625,
        "MAPE": 0.18415099382400513,
        "sMAPE": 0.1690668910741806,
        "MASE": 0.6635231157439309,
        "R2": 0.7866491079330444,
        "NRMSE": 0.10066103029625686
      },
      "Public": {
        "MAE": 50.070987701416016,
        "RMSE": 73.9654541015625,
        "MAPE": 0.22648246586322784,
        "sMAPE": 0.21499000489711761,
        "MASE": 1.4239018298370245,
        "R2": 0.7160367965698242,
        "NRMSE": 0.10883675214642403
      },
      "Residential": {
        "MAE": 54.292823791503906,
        "RMSE": 82.08903503417969,
        "MAPE": 0.17799660563468933,
        "sMAPE": 0.16754156351089478,
        "MASE": 2.12537919232073,
        "R2": 0.2503024935722351,
        "NRMSE": 0.14094957347703982
      }
    },
    "avg": {
      "MAE": 74.87171840667725,
      "RMSE": 116.94736862182617,
      "MAPE": 0.2106180228292942,
      "sMAPE": 0.17925243079662323,
      "MASE": 1.5475487775783594,
      "R2": 0.581421747803688,
      "NRMSE": 0.11077194745441171
    },
    "total": {
      "MAE": 255.00076293945312,
      "RMSE": 346.7999572753906,
      "MAPE": 0.15557214617729187,
      "sMAPE": 0.15167365968227386,
      "R2": 0.6069573163986206,
      "NRMSE": 0.12021711340328332
    }
  },
  "micro_batch": 512,
  "effective_batch": 32,
  "accum_steps": 1,
  "clip_nonneg": false,
  "exports": {
    "test": {
      "npz": "C:\\Users\\13470\\Desktop\\C_school\\TransformerRuns\\MultiBuildingMSPatchTST\\20260119_135326_3c1e6694\\5_minutes\\Joint_Commercial-Office-Public-Residential\\preds\\test_samples.npz",
      "plots_dir": "C:\\Users\\13470\\Desktop\\C_school\\TransformerRuns\\MultiBuildingMSPatchTST\\20260119_135326_3c1e6694\\5_minutes\\Joint_Commercial-Office-Public-Residential\\preds\\plots",
      "export_k": 64,
      "plot_k": 12,
      "strategy": "uniform"
    }
  },
  "explain": {},
  "timestamp": "2026-01-19 16:14:13"
}