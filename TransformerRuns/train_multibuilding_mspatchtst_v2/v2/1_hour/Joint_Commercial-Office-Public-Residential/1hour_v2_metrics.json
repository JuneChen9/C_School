{
  "model": "MultiBuildingMSPatchTST",
  "resolution": "1_hour",
  "buildings": [
    "Commercial",
    "Office",
    "Public",
    "Residential"
  ],
  "series_dir": "C:\\Users\\13470\\Desktop\\C_school\\AfterWash\\1_hour",
  "window": {
    "input_len": 168,
    "pred_len": 24
  },
  "patch_scales": [
    [
      12,
      6
    ],
    [
      24,
      12
    ]
  ],
  "model_cfg": {
    "d_model": 192,
    "n_heads": 8,
    "n_layers": 4,
    "d_ff": 384
  },
  "train_cfg": {
    "epochs": 30,
    "micro_batch": 32,
    "effective_batch": 32,
    "lr": 0.001,
    "weight_decay": 0.0001,
    "dropout": 0.1,
    "d_model": 256,
    "n_heads": 8,
    "n_layers": 6,
    "d_ff": 512,
    "huber_beta": 1.0,
    "total_loss_weight": 0.1,
    "residual_reg": 0.001,
    "fusion": "gated_residual",
    "gate_mode": "building",
    "gate_init": -2.0,
    "gate_max": 0.7,
    "gate_reg": 0.01,
    "grad_clip": 1.0,
    "patience": 6,
    "num_workers": 2,
    "save_every": 1,
    "grad_checkpoint": false,
    "auto_res_tune": true,
    "auto_quantiles": true
  },
  "best_val_loss_scaled": 24.16700553894043,
  "val_metrics": {
    "per_building": {
      "Commercial": {
        "MAE": 102.47276306152344,
        "RMSE": 142.762939453125,
        "MAPE": 0.18020085990428925,
        "sMAPE": 0.18367838859558105,
        "MASE": 1.6951074291028625,
        "R2": 0.47066640853881836,
        "NRMSE": 0.1312980047320604
      },
      "Office": {
        "MAE": 118.61747741699219,
        "RMSE": 202.4203338623047,
        "MAPE": 0.29146748781204224,
        "sMAPE": 0.27043232321739197,
        "MASE": 1.090146990128998,
        "R2": 0.6489551663398743,
        "NRMSE": 0.17195068149705578
      },
      "Public": {
        "MAE": 54.769081115722656,
        "RMSE": 82.0199203491211,
        "MAPE": 0.2966032028198242,
        "sMAPE": 0.31107357144355774,
        "MASE": 1.5545450135711802,
        "R2": 0.3952181935310364,
        "NRMSE": 0.15809543683426627
      },
      "Residential": {
        "MAE": 39.240745544433594,
        "RMSE": 55.38544845581055,
        "MAPE": 0.14862588047981262,
        "sMAPE": 0.1573568731546402,
        "MASE": 1.534151857787031,
        "R2": 0.6113051176071167,
        "NRMSE": 0.0871758723277486
      }
    },
    "avg": {
      "MAE": 78.77501678466797,
      "RMSE": 120.64716053009033,
      "MAPE": 0.22922435775399208,
      "sMAPE": 0.23063528910279274,
      "MASE": 1.468487822647518,
      "R2": 0.5315362215042114,
      "NRMSE": 0.13712999884778276
    },
    "total": {
      "MAE": 247.8322296142578,
      "RMSE": 358.470947265625,
      "MAPE": 0.17100924253463745,
      "sMAPE": 0.17291341722011566,
      "R2": 0.5230551362037659,
      "NRMSE": 0.15431447679371635
    }
  },
  "test_metrics": {
    "per_building": {
      "Commercial": {
        "MAE": 110.30367279052734,
        "RMSE": 169.76638793945312,
        "MAPE": 0.14701204001903534,
        "sMAPE": 0.14513517916202545,
        "MASE": 1.8246465657639743,
        "R2": 0.6004265546798706,
        "NRMSE": 0.10202122855390224
      },
      "Office": {
        "MAE": 79.08480072021484,
        "RMSE": 124.33072662353516,
        "MAPE": 0.23788388073444366,
        "sMAPE": 0.24901646375656128,
        "MASE": 0.7268242365921659,
        "R2": 0.8178113698959351,
        "NRMSE": 0.09891068148252598
      },
      "Public": {
        "MAE": 41.406124114990234,
        "RMSE": 59.95694351196289,
        "MAPE": 0.20266947150230408,
        "sMAPE": 0.20259162783622742,
        "MASE": 1.17525586449522,
        "R2": 0.8164427280426025,
        "NRMSE": 0.09292768502416573
      },
      "Residential": {
        "MAE": 47.28864288330078,
        "RMSE": 75.63282775878906,
        "MAPE": 0.1554913967847824,
        "sMAPE": 0.14700181782245636,
        "MASE": 1.848791564102545,
        "R2": 0.36970722675323486,
        "NRMSE": 0.14286517618222463
      }
    },
    "avg": {
      "MAE": 69.5208101272583,
      "RMSE": 107.42172145843506,
      "MAPE": 0.18576419726014137,
      "sMAPE": 0.18593627214431763,
      "MASE": 1.3938795577384764,
      "R2": 0.6510969698429108,
      "NRMSE": 0.10918119281070465
    },
    "total": {
      "MAE": 190.7982177734375,
      "RMSE": 270.9341735839844,
      "MAPE": 0.11516467481851578,
      "sMAPE": 0.11529076099395752,
      "R2": 0.7582603693008423,
      "NRMSE": 0.09540608219521966
    }
  },
  "baseline_mode": "weekly",
  "fusion": "gated_residual",
  "gate_mode": "building",
  "gate_max": 0.7,
  "gate_reg": 0.01,
  "residual_reg": 0.001,
  "total_loss_weight": 0.1,
  "huber_beta": 1.0,
  "baseline_val_metrics": {
    "per_building": {
      "Commercial": {
        "MAE": 111.45233917236328,
        "RMSE": 153.05096435546875,
        "MAPE": 0.20167870819568634,
        "sMAPE": 0.19683660566806793,
        "MASE": 1.843647838485017,
        "R2": 0.3916260004043579,
        "NRMSE": 0.14075982407737453
      },
      "Office": {
        "MAE": 103.45787811279297,
        "RMSE": 209.26585388183594,
        "MAPE": 0.23334477841854095,
        "sMAPE": 0.1892213225364685,
        "MASE": 0.9508235791704455,
        "R2": 0.6248102188110352,
        "NRMSE": 0.17776576840112562
      },
      "Public": {
        "MAE": 54.889739990234375,
        "RMSE": 85.4296646118164,
        "MAPE": 0.29057207703590393,
        "sMAPE": 0.26237934827804565,
        "MASE": 1.5579697497159948,
        "R2": 0.3438887596130371,
        "NRMSE": 0.16466780372281478
      },
      "Residential": {
        "MAE": 39.657981872558594,
        "RMSE": 55.80607986450195,
        "MAPE": 0.15442481637001038,
        "sMAPE": 0.156887948513031,
        "MASE": 1.5504640832314838,
        "R2": 0.6053788065910339,
        "NRMSE": 0.087837939910543
      }
    },
    "avg": {
      "MAE": 77.3644847869873,
      "RMSE": 125.88814067840576,
      "MAPE": 0.2200050950050354,
      "sMAPE": 0.20133130624890327,
      "MASE": 1.4757263126507352,
      "R2": 0.49142594635486603,
      "NRMSE": 0.1427578340279645
    },
    "total": {
      "MAE": 266.4501953125,
      "RMSE": 386.8438720703125,
      "MAPE": 0.18507583439350128,
      "sMAPE": 0.17682527005672455,
      "R2": 0.4445670247077942,
      "NRMSE": 0.16652844581893408
    }
  },
  "baseline_test_metrics": {
    "per_building": {
      "Commercial": {
        "MAE": 129.20828247070312,
        "RMSE": 191.70082092285156,
        "MAPE": 0.1757652759552002,
        "sMAPE": 0.17045184969902039,
        "MASE": 2.137367169324905,
        "R2": 0.49050360918045044,
        "NRMSE": 0.11520274126534452
      },
      "Office": {
        "MAE": 70.4913558959961,
        "RMSE": 133.82403564453125,
        "MAPE": 0.18305425345897675,
        "sMAPE": 0.1674814075231552,
        "MASE": 0.6478466844307027,
        "R2": 0.7889271378517151,
        "NRMSE": 0.10646303551673131
      },
      "Public": {
        "MAE": 48.47207260131836,
        "RMSE": 73.05413818359375,
        "MAPE": 0.21872375905513763,
        "sMAPE": 0.20748980343341827,
        "MASE": 1.3758130906126933,
        "R2": 0.7274900674819946,
        "NRMSE": 0.1132271184151066
      },
      "Residential": {
        "MAE": 54.95962142944336,
        "RMSE": 82.48458099365234,
        "MAPE": 0.18015389144420624,
        "sMAPE": 0.16966180503368378,
        "MASE": 2.148695294888783,
        "R2": 0.2503352165222168,
        "NRMSE": 0.1558076637509526
      }
    },
    "avg": {
      "MAE": 75.78283309936523,
      "RMSE": 120.26589393615723,
      "MAPE": 0.1894242949783802,
      "sMAPE": 0.1787712164223194,
      "MASE": 1.577430559814271,
      "R2": 0.5643140077590942,
      "NRMSE": 0.12267513973703376
    },
    "total": {
      "MAE": 258.0083312988281,
      "RMSE": 355.2920227050781,
      "MAPE": 0.15725548565387726,
      "sMAPE": 0.15298296511173248,
      "R2": 0.5842893123626709,
      "NRMSE": 0.12511164417950071
    }
  },
  "micro_batch": 512,
  "effective_batch": 32,
  "accum_steps": 1,
  "clip_nonneg": false,
  "exports": {
    "test": {
      "npz": "C:\\Users\\13470\\Desktop\\C_school\\TransformerRuns\\MultiBuildingMSPatchTST\\20260119_135326_3c1e6694\\1_hour\\Joint_Commercial-Office-Public-Residential\\preds\\test_samples.npz",
      "plots_dir": "C:\\Users\\13470\\Desktop\\C_school\\TransformerRuns\\MultiBuildingMSPatchTST\\20260119_135326_3c1e6694\\1_hour\\Joint_Commercial-Office-Public-Residential\\preds\\plots",
      "export_k": 64,
      "plot_k": 12,
      "strategy": "uniform"
    }
  },
  "explain": {},
  "timestamp": "2026-01-19 13:54:14"
}