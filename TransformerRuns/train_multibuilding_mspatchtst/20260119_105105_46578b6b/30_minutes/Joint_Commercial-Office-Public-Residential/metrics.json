{
  "model": "MultiBuildingMSPatchTST",
  "resolution": "30_minutes",
  "buildings": [
    "Commercial",
    "Office",
    "Public",
    "Residential"
  ],
  "series_dir": "C:\\Users\\13470\\Desktop\\C_school\\AfterWash\\30_minutes",
  "window": {
    "input_len": 336,
    "pred_len": 48
  },
  "patch_scales": [
    [
      24,
      12
    ],
    [
      48,
      24
    ]
  ],
  "model_cfg": {
    "d_model": 256,
    "n_heads": 8,
    "n_layers": 6,
    "d_ff": 512
  },
  "train_cfg": {
    "epochs": 30,
    "micro_batch": 32,
    "effective_batch": 32,
    "lr": 0.001,
    "weight_decay": 0.0001,
    "dropout": 0.1,
    "d_model": 256,
    "n_heads": 8,
    "n_layers": 6,
    "d_ff": 512,
    "grad_clip": 1.0,
    "patience": 6,
    "num_workers": 2,
    "save_every": 1,
    "grad_checkpoint": false
  },
  "best_val_loss_scaled": 0.15224117046842972,
  "val_metrics": {
    "per_building": {
      "Commercial": {
        "MAE": 114.58708190917969,
        "RMSE": 159.66737365722656,
        "MAPE": 0.217783585190773,
        "sMAPE": 0.20340339839458466,
        "MASE": 1.866034912588074,
        "R2": 0.34182560443878174,
        "NRMSE": 0.1397159317773535
      },
      "Office": {
        "MAE": 103.34404754638672,
        "RMSE": 204.70001220703125,
        "MAPE": 0.25309833884239197,
        "sMAPE": 0.192267507314682,
        "MASE": 0.9668928946510533,
        "R2": 0.6383144855499268,
        "NRMSE": 0.17388720752430986
      },
      "Public": {
        "MAE": 56.58224105834961,
        "RMSE": 87.17866516113281,
        "MAPE": 0.30813831090927124,
        "sMAPE": 0.26816326379776,
        "MASE": 1.6189883194243517,
        "R2": 0.324146568775177,
        "NRMSE": 0.1599021702296442
      },
      "Residential": {
        "MAE": 40.232513427734375,
        "RMSE": 56.62300491333008,
        "MAPE": 0.16865915060043335,
        "sMAPE": 0.16069146990776062,
        "MASE": 1.5704003245413876,
        "R2": 0.595538318157196,
        "NRMSE": 0.08912376779031182
      }
    },
    "avg": {
      "MAE": 78.6864709854126,
      "RMSE": 127.04226398468018,
      "MAPE": 0.2369198463857174,
      "sMAPE": 0.20613140985369682,
      "MASE": 1.5055791128012166,
      "R2": 0.4749562442302704,
      "NRMSE": 0.14065726933040484
    },
    "total": {
      "MAE": 263.4591979980469,
      "RMSE": 394.6820983886719,
      "MAPE": 0.19420981407165527,
      "sMAPE": 0.17151638865470886,
      "R2": 0.4249092936515808,
      "NRMSE": 0.16990264337255645
    }
  },
  "test_metrics": {
    "per_building": {
      "Commercial": {
        "MAE": 121.9719009399414,
        "RMSE": 175.67471313476562,
        "MAPE": 0.1663898229598999,
        "sMAPE": 0.16128750145435333,
        "MASE": 1.9862956776319758,
        "R2": 0.5821478962898254,
        "NRMSE": 0.10535468923444222
      },
      "Office": {
        "MAE": 72.9542465209961,
        "RMSE": 133.167724609375,
        "MAPE": 0.18824245035648346,
        "sMAPE": 0.18024028837680817,
        "MASE": 0.6825641560449869,
        "R2": 0.7915613651275635,
        "NRMSE": 0.10267682011795914
      },
      "Public": {
        "MAE": 57.071353912353516,
        "RMSE": 79.88008117675781,
        "MAPE": 0.2899324297904968,
        "sMAPE": 0.25068557262420654,
        "MASE": 1.632983311186803,
        "R2": 0.6654926538467407,
        "NRMSE": 0.12380670679170361
      },
      "Residential": {
        "MAE": 64.0093994140625,
        "RMSE": 100.3639144897461,
        "MAPE": 0.21591581404209137,
        "sMAPE": 0.1991773545742035,
        "MASE": 2.4984862502835603,
        "R2": -0.12190961837768555,
        "NRMSE": 0.18348064806169304
      }
    },
    "avg": {
      "MAE": 79.00172519683838,
      "RMSE": 122.27160835266113,
      "MAPE": 0.2151201292872429,
      "sMAPE": 0.19784767925739288,
      "MASE": 1.7000823487868315,
      "R2": 0.479323074221611,
      "NRMSE": 0.1288297160514495
    },
    "total": {
      "MAE": 270.416259765625,
      "RMSE": 360.8143310546875,
      "MAPE": 0.1644076555967331,
      "sMAPE": 0.15898649394512177,
      "R2": 0.5761817097663879,
      "NRMSE": 0.1267327078228937
    }
  },
  "baseline_mode": "weekly",
  "baseline_val_metrics": {
    "per_building": {
      "Commercial": {
        "MAE": 109.87394714355469,
        "RMSE": 150.3970184326172,
        "MAPE": 0.19903114438056946,
        "sMAPE": 0.19414891302585602,
        "MASE": 1.7892821593644639,
        "R2": 0.4160346984863281,
        "NRMSE": 0.13160396570409721
      },
      "Office": {
        "MAE": 98.60013580322266,
        "RMSE": 202.760986328125,
        "MAPE": 0.2233591079711914,
        "sMAPE": 0.18128985166549683,
        "MASE": 0.9225085816091417,
        "R2": 0.6451342105865479,
        "NRMSE": 0.17224005669239215
      },
      "Public": {
        "MAE": 54.8112678527832,
        "RMSE": 84.65929412841797,
        "MAPE": 0.28761252760887146,
        "sMAPE": 0.2613063454627991,
        "MASE": 1.5683154425605885,
        "R2": 0.3626450300216675,
        "NRMSE": 0.15528116697156258
      },
      "Residential": {
        "MAE": 39.23930740356445,
        "RMSE": 55.44549560546875,
        "MAPE": 0.1515941321849823,
        "sMAPE": 0.15449701249599457,
        "MASE": 1.5316323995521997,
        "R2": 0.6121854782104492,
        "NRMSE": 0.08727038564845277
      }
    },
    "avg": {
      "MAE": 75.63116455078125,
      "RMSE": 123.31569862365723,
      "MAPE": 0.21539922803640366,
      "sMAPE": 0.19781053066253662,
      "MASE": 1.4529346457715984,
      "R2": 0.5089998543262482,
      "NRMSE": 0.13659889375412618
    },
    "total": {
      "MAE": 262.0980224609375,
      "RMSE": 380.8123779296875,
      "MAPE": 0.18239788711071014,
      "sMAPE": 0.17431163787841797,
      "R2": 0.4646182060241699,
      "NRMSE": 0.16393200984638306
    }
  },
  "baseline_test_metrics": {
    "per_building": {
      "Commercial": {
        "MAE": 121.20899200439453,
        "RMSE": 175.35386657714844,
        "MAPE": 0.16380932927131653,
        "sMAPE": 0.1603318154811859,
        "MASE": 1.9738718102541137,
        "R2": 0.5836727619171143,
        "NRMSE": 0.10516227287145792
      },
      "Office": {
        "MAE": 70.33576202392578,
        "RMSE": 133.5695037841797,
        "MAPE": 0.18307894468307495,
        "sMAPE": 0.16800659894943237,
        "MASE": 0.6580654634247389,
        "R2": 0.7903016805648804,
        "NRMSE": 0.10298660545205246
      },
      "Public": {
        "MAE": 51.03562545776367,
        "RMSE": 77.55400085449219,
        "MAPE": 0.2256796807050705,
        "sMAPE": 0.21402768790721893,
        "MASE": 1.4602829429366102,
        "R2": 0.6846904754638672,
        "NRMSE": 0.12020149833184435
      },
      "Residential": {
        "MAE": 54.538299560546875,
        "RMSE": 82.06520080566406,
        "MAPE": 0.17881210148334503,
        "sMAPE": 0.16862158477306366,
        "MASE": 2.1287997202475872,
        "R2": 0.24989724159240723,
        "NRMSE": 0.1500277894070641
      }
    },
    "avg": {
      "MAE": 74.27966976165771,
      "RMSE": 117.1356430053711,
      "MAPE": 0.18784501403570175,
      "sMAPE": 0.17774692177772522,
      "MASE": 1.5552549842157624,
      "R2": 0.5771405398845673,
      "NRMSE": 0.1195945415156047
    },
    "total": {
      "MAE": 254.15159606933594,
      "RMSE": 348.0463562011719,
      "MAPE": 0.15460485219955444,
      "sMAPE": 0.15090817213058472,
      "R2": 0.6056458950042725,
      "NRMSE": 0.12224807434985296
    }
  },
  "micro_batch": 256,
  "effective_batch": 32,
  "accum_steps": 1,
  "clip_nonneg": true,
  "exports": {
    "test": {
      "npz": "C:\\Users\\13470\\Desktop\\C_school\\TransformerRuns\\MultiBuildingMSPatchTST\\20260119_105105_46578b6b\\30_minutes\\Joint_Commercial-Office-Public-Residential\\preds\\test_samples.npz",
      "plots_dir": "C:\\Users\\13470\\Desktop\\C_school\\TransformerRuns\\MultiBuildingMSPatchTST\\20260119_105105_46578b6b\\30_minutes\\Joint_Commercial-Office-Public-Residential\\preds\\plots",
      "export_k": 64,
      "plot_k": 12,
      "strategy": "uniform"
    }
  },
  "explain": {
    "dir": "C:\\Users\\13470\\Desktop\\C_school\\TransformerRuns\\MultiBuildingMSPatchTST\\20260119_105105_46578b6b\\30_minutes\\Joint_Commercial-Office-Public-Residential\\explain"
  },
  "timestamp": "2026-01-19 10:55:00"
}