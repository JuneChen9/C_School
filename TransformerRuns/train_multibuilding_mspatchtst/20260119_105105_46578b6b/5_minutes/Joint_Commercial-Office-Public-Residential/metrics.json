{
  "model": "MultiBuildingMSPatchTST",
  "resolution": "5_minutes",
  "buildings": [
    "Commercial",
    "Office",
    "Public",
    "Residential"
  ],
  "series_dir": "C:\\Users\\13470\\Desktop\\C_school\\AfterWash\\5_minutes",
  "window": {
    "input_len": 2016,
    "pred_len": 288
  },
  "patch_scales": [
    [
      32,
      16
    ],
    [
      64,
      32
    ]
  ],
  "model_cfg": {
    "d_model": 256,
    "n_heads": 8,
    "n_layers": 6,
    "d_ff": 512
  },
  "train_cfg": {
    "epochs": 30,
    "micro_batch": 32,
    "effective_batch": 32,
    "lr": 0.001,
    "weight_decay": 0.0001,
    "dropout": 0.1,
    "d_model": 256,
    "n_heads": 8,
    "n_layers": 6,
    "d_ff": 512,
    "grad_clip": 1.0,
    "patience": 6,
    "num_workers": 2,
    "save_every": 1,
    "grad_checkpoint": false
  },
  "best_val_loss_scaled": 0.09440715892494402,
  "val_metrics": {
    "per_building": {
      "Commercial": {
        "MAE": 87.60191345214844,
        "RMSE": 122.77790832519531,
        "MAPE": 0.15620030462741852,
        "sMAPE": 0.15338461101055145,
        "MASE": 1.395873828455278,
        "R2": 0.6102467775344849,
        "NRMSE": 0.107436036996233
      },
      "Office": {
        "MAE": 73.99710845947266,
        "RMSE": 130.99908447265625,
        "MAPE": 0.17172200977802277,
        "sMAPE": 0.14707832038402557,
        "MASE": 0.6912748946511192,
        "R2": 0.8517827391624451,
        "NRMSE": 0.10761622742494503
      },
      "Public": {
        "MAE": 45.54570007324219,
        "RMSE": 68.45384979248047,
        "MAPE": 0.24195975065231323,
        "sMAPE": 0.2194477915763855,
        "MASE": 1.2952132293101102,
        "R2": 0.57321697473526,
        "NRMSE": 0.11917452451766396
      },
      "Residential": {
        "MAE": 33.28753662109375,
        "RMSE": 45.612159729003906,
        "MAPE": 0.12833671271800995,
        "sMAPE": 0.1316613405942917,
        "MASE": 1.3030937195268553,
        "R2": 0.7353441715240479,
        "NRMSE": 0.06742373943681287
      }
    },
    "avg": {
      "MAE": 60.10806465148926,
      "RMSE": 91.96075057983398,
      "MAPE": 0.17455469444394112,
      "sMAPE": 0.16289301589131355,
      "MASE": 1.1713639179858408,
      "R2": 0.6926476657390594,
      "NRMSE": 0.10041263209391371
    },
    "total": {
      "MAE": 191.4499053955078,
      "RMSE": 268.27691650390625,
      "MAPE": 0.13216696679592133,
      "sMAPE": 0.12744121253490448,
      "R2": 0.7345261573791504,
      "NRMSE": 0.1111577136230486
    }
  },
  "test_metrics": {
    "per_building": {
      "Commercial": {
        "MAE": 94.53870391845703,
        "RMSE": 134.87472534179688,
        "MAPE": 0.19690483808517456,
        "sMAPE": 0.12846389412879944,
        "MASE": 1.5064066225898196,
        "R2": 0.7547803521156311,
        "NRMSE": 0.07017963267433297
      },
      "Office": {
        "MAE": 121.71601104736328,
        "RMSE": 202.2974853515625,
        "MAPE": 0.35793766379356384,
        "sMAPE": 0.2548849284648895,
        "MASE": 1.1370609536750018,
        "R2": 0.5115143060684204,
        "NRMSE": 0.15231407477449127
      },
      "Public": {
        "MAE": 46.21257400512695,
        "RMSE": 65.41202545166016,
        "MAPE": 0.22597460448741913,
        "sMAPE": 0.2017679065465927,
        "MASE": 1.3141775648559513,
        "R2": 0.7779148817062378,
        "NRMSE": 0.09625077663556891
      },
      "Residential": {
        "MAE": 37.3819580078125,
        "RMSE": 54.72209548950195,
        "MAPE": 0.12470138818025589,
        "sMAPE": 0.12208572775125504,
        "MASE": 1.4633763759114877,
        "R2": 0.6668489575386047,
        "NRMSE": 0.09395963804183632
      }
    },
    "avg": {
      "MAE": 74.96231174468994,
      "RMSE": 114.32658290863037,
      "MAPE": 0.22637962363660336,
      "sMAPE": 0.17680061422288418,
      "MASE": 1.355255379258065,
      "R2": 0.6777646243572235,
      "NRMSE": 0.10317603053155737
    },
    "total": {
      "MAE": 226.64971923828125,
      "RMSE": 312.9051208496094,
      "MAPE": 0.14843696355819702,
      "sMAPE": 0.13505539298057556,
      "R2": 0.6800316572189331,
      "NRMSE": 0.1084675750630921
    }
  },
  "baseline_mode": "weekly",
  "baseline_val_metrics": {
    "per_building": {
      "Commercial": {
        "MAE": 108.2773666381836,
        "RMSE": 148.58396911621094,
        "MAPE": 0.1966618001461029,
        "sMAPE": 0.19177857041358948,
        "MASE": 1.7253223856446527,
        "R2": 0.4291878342628479,
        "NRMSE": 0.1300174682951538
      },
      "Office": {
        "MAE": 100.67927551269531,
        "RMSE": 206.70138549804688,
        "MAPE": 0.22917819023132324,
        "sMAPE": 0.1852828413248062,
        "MASE": 0.9405375023769604,
        "R2": 0.6309806704521179,
        "NRMSE": 0.16980594483049366
      },
      "Public": {
        "MAE": 54.4230842590332,
        "RMSE": 84.69024658203125,
        "MAPE": 0.2869228720664978,
        "sMAPE": 0.25967371463775635,
        "MASE": 1.547665281218737,
        "R2": 0.3467519283294678,
        "NRMSE": 0.14744123081892727
      },
      "Residential": {
        "MAE": 39.08098220825195,
        "RMSE": 55.3955078125,
        "MAPE": 0.15102237462997437,
        "sMAPE": 0.15389877557754517,
        "MASE": 1.5298873884300235,
        "R2": 0.6096364259719849,
        "NRMSE": 0.08188545131189948
      }
    },
    "avg": {
      "MAE": 75.61517715454102,
      "RMSE": 123.84277725219727,
      "MAPE": 0.21594630926847458,
      "sMAPE": 0.1976584754884243,
      "MASE": 1.4358531394175935,
      "R2": 0.5041392147541046,
      "NRMSE": 0.13228752381411854
    },
    "total": {
      "MAE": 262.6336975097656,
      "RMSE": 382.3007507324219,
      "MAPE": 0.18317990005016327,
      "sMAPE": 0.17478585243225098,
      "R2": 0.4609047770500183,
      "NRMSE": 0.15840228791049296
    }
  },
  "baseline_test_metrics": {
    "per_building": {
      "Commercial": {
        "MAE": 124.09662628173828,
        "RMSE": 178.041015625,
        "MAPE": 0.2538420259952545,
        "sMAPE": 0.16541126370429993,
        "MASE": 1.9773909724117515,
        "R2": 0.5726985931396484,
        "NRMSE": 0.09264043389792613
      },
      "Office": {
        "MAE": 71.02643585205078,
        "RMSE": 133.6939697265625,
        "MAPE": 0.18415099382400513,
        "sMAPE": 0.1690668910741806,
        "MASE": 0.6635231157439309,
        "R2": 0.7866491079330444,
        "NRMSE": 0.10066103029625686
      },
      "Public": {
        "MAE": 50.070987701416016,
        "RMSE": 73.9654541015625,
        "MAPE": 0.22648246586322784,
        "sMAPE": 0.21499000489711761,
        "MASE": 1.4239018298370245,
        "R2": 0.7160367965698242,
        "NRMSE": 0.10883675214642403
      },
      "Residential": {
        "MAE": 54.292823791503906,
        "RMSE": 82.08903503417969,
        "MAPE": 0.17799660563468933,
        "sMAPE": 0.16754156351089478,
        "MASE": 2.12537919232073,
        "R2": 0.2503024935722351,
        "NRMSE": 0.14094957347703982
      }
    },
    "avg": {
      "MAE": 74.87171840667725,
      "RMSE": 116.94736862182617,
      "MAPE": 0.2106180228292942,
      "sMAPE": 0.17925243079662323,
      "MASE": 1.5475487775783594,
      "R2": 0.581421747803688,
      "NRMSE": 0.11077194745441171
    },
    "total": {
      "MAE": 255.00076293945312,
      "RMSE": 346.7999572753906,
      "MAPE": 0.15557214617729187,
      "sMAPE": 0.15167365968227386,
      "R2": 0.6069573163986206,
      "NRMSE": 0.12021711340328332
    }
  },
  "micro_batch": 256,
  "effective_batch": 32,
  "accum_steps": 1,
  "clip_nonneg": true,
  "exports": {
    "test": {
      "npz": "C:\\Users\\13470\\Desktop\\C_school\\TransformerRuns\\MultiBuildingMSPatchTST\\20260119_105105_46578b6b\\5_minutes\\Joint_Commercial-Office-Public-Residential\\preds\\test_samples.npz",
      "plots_dir": "C:\\Users\\13470\\Desktop\\C_school\\TransformerRuns\\MultiBuildingMSPatchTST\\20260119_105105_46578b6b\\5_minutes\\Joint_Commercial-Office-Public-Residential\\preds\\plots",
      "export_k": 64,
      "plot_k": 12,
      "strategy": "uniform"
    }
  },
  "explain": {
    "dir": "C:\\Users\\13470\\Desktop\\C_school\\TransformerRuns\\MultiBuildingMSPatchTST\\20260119_105105_46578b6b\\5_minutes\\Joint_Commercial-Office-Public-Residential\\explain"
  },
  "timestamp": "2026-01-19 11:49:05"
}