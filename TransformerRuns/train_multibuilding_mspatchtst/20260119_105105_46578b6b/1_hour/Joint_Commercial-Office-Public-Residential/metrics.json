{
  "model": "MultiBuildingMSPatchTST",
  "resolution": "1_hour",
  "buildings": [
    "Commercial",
    "Office",
    "Public",
    "Residential"
  ],
  "series_dir": "C:\\Users\\13470\\Desktop\\C_school\\AfterWash\\1_hour",
  "window": {
    "input_len": 168,
    "pred_len": 24
  },
  "patch_scales": [
    [
      12,
      6
    ],
    [
      24,
      12
    ]
  ],
  "model_cfg": {
    "d_model": 256,
    "n_heads": 8,
    "n_layers": 6,
    "d_ff": 512
  },
  "train_cfg": {
    "epochs": 30,
    "micro_batch": 32,
    "effective_batch": 32,
    "lr": 0.001,
    "weight_decay": 0.0001,
    "dropout": 0.1,
    "d_model": 256,
    "n_heads": 8,
    "n_layers": 6,
    "d_ff": 512,
    "grad_clip": 1.0,
    "patience": 6,
    "num_workers": 2,
    "save_every": 1,
    "grad_checkpoint": false
  },
  "best_val_loss_scaled": 0.1549493280549844,
  "val_metrics": {
    "per_building": {
      "Commercial": {
        "MAE": 117.19952392578125,
        "RMSE": 161.88412475585938,
        "MAPE": 0.225115567445755,
        "sMAPE": 0.19754986464977264,
        "MASE": 1.9387179359517601,
        "R2": 0.3193764090538025,
        "NRMSE": 0.14888361545132797
      },
      "Office": {
        "MAE": 105.11507415771484,
        "RMSE": 210.08966064453125,
        "MAPE": 0.24448709189891815,
        "sMAPE": 0.19109772145748138,
        "MASE": 0.9660539425179504,
        "R2": 0.6218503713607788,
        "NRMSE": 0.17846557030128307
      },
      "Public": {
        "MAE": 57.3516960144043,
        "RMSE": 89.14704132080078,
        "MAPE": 0.3190142512321472,
        "sMAPE": 0.2689325511455536,
        "MASE": 1.6278489841862294,
        "R2": 0.28554654121398926,
        "NRMSE": 0.17183313980437692
      },
      "Residential": {
        "MAE": 39.11369705200195,
        "RMSE": 54.52384567260742,
        "MAPE": 0.16450262069702148,
        "sMAPE": 0.15292812883853912,
        "MASE": 1.5291847839460833,
        "R2": 0.6233046054840088,
        "NRMSE": 0.08581972235839921
      }
    },
    "avg": {
      "MAE": 79.69499778747559,
      "RMSE": 128.9111680984497,
      "MAPE": 0.23827988281846046,
      "sMAPE": 0.20262706652283669,
      "MASE": 1.5154514116505058,
      "R2": 0.46251948177814484,
      "NRMSE": 0.1462505119788468
    },
    "total": {
      "MAE": 273.66156005859375,
      "RMSE": 402.0819396972656,
      "MAPE": 0.1996271312236786,
      "sMAPE": 0.17586275935173035,
      "R2": 0.3999474048614502,
      "NRMSE": 0.17308812506529186
    }
  },
  "test_metrics": {
    "per_building": {
      "Commercial": {
        "MAE": 133.20556640625,
        "RMSE": 195.9742431640625,
        "MAPE": 0.17776541411876678,
        "sMAPE": 0.17904606461524963,
        "MASE": 2.2034903565303767,
        "R2": 0.4675348997116089,
        "NRMSE": 0.11777085732453406
      },
      "Office": {
        "MAE": 70.52268981933594,
        "RMSE": 133.20339965820312,
        "MAPE": 0.18194296956062317,
        "sMAPE": 0.16975727677345276,
        "MASE": 0.6481346570209288,
        "R2": 0.7908803224563599,
        "NRMSE": 0.10596929169308124
      },
      "Public": {
        "MAE": 50.12189865112305,
        "RMSE": 73.18636322021484,
        "MAPE": 0.22749286890029907,
        "sMAPE": 0.22807851433753967,
        "MASE": 1.4226411331274955,
        "R2": 0.7265027165412903,
        "NRMSE": 0.1134320549218013
      },
      "Residential": {
        "MAE": 60.14455032348633,
        "RMSE": 93.90847778320312,
        "MAPE": 0.19777436554431915,
        "sMAPE": 0.18809469044208527,
        "MASE": 2.3514047027995626,
        "R2": 0.028302133083343506,
        "NRMSE": 0.1773866140016533
      }
    },
    "avg": {
      "MAE": 78.49867630004883,
      "RMSE": 124.0681209564209,
      "MAPE": 0.19624390453100204,
      "sMAPE": 0.19124413654208183,
      "MASE": 1.6564177123695907,
      "R2": 0.5033050179481506,
      "NRMSE": 0.12863970448526746
    },
    "total": {
      "MAE": 274.4014892578125,
      "RMSE": 369.5604248046875,
      "MAPE": 0.16399310529232025,
      "sMAPE": 0.16489365696907043,
      "R2": 0.5502293109893799,
      "NRMSE": 0.1301360836051452
    }
  },
  "baseline_mode": "weekly",
  "baseline_val_metrics": {
    "per_building": {
      "Commercial": {
        "MAE": 111.45233917236328,
        "RMSE": 153.05096435546875,
        "MAPE": 0.20167870819568634,
        "sMAPE": 0.19683660566806793,
        "MASE": 1.843647838485017,
        "R2": 0.3916260004043579,
        "NRMSE": 0.14075982407737453
      },
      "Office": {
        "MAE": 103.45787811279297,
        "RMSE": 209.26585388183594,
        "MAPE": 0.23334477841854095,
        "sMAPE": 0.1892213225364685,
        "MASE": 0.9508235791704455,
        "R2": 0.6248102188110352,
        "NRMSE": 0.17776576840112562
      },
      "Public": {
        "MAE": 54.889739990234375,
        "RMSE": 85.4296646118164,
        "MAPE": 0.29057207703590393,
        "sMAPE": 0.26237934827804565,
        "MASE": 1.5579697497159948,
        "R2": 0.3438887596130371,
        "NRMSE": 0.16466780372281478
      },
      "Residential": {
        "MAE": 39.657981872558594,
        "RMSE": 55.80607986450195,
        "MAPE": 0.15442481637001038,
        "sMAPE": 0.156887948513031,
        "MASE": 1.5504640832314838,
        "R2": 0.6053788065910339,
        "NRMSE": 0.087837939910543
      }
    },
    "avg": {
      "MAE": 77.3644847869873,
      "RMSE": 125.88814067840576,
      "MAPE": 0.2200050950050354,
      "sMAPE": 0.20133130624890327,
      "MASE": 1.4757263126507352,
      "R2": 0.49142594635486603,
      "NRMSE": 0.1427578340279645
    },
    "total": {
      "MAE": 266.4501953125,
      "RMSE": 386.8438720703125,
      "MAPE": 0.18507583439350128,
      "sMAPE": 0.17682527005672455,
      "R2": 0.4445670247077942,
      "NRMSE": 0.16652844581893408
    }
  },
  "baseline_test_metrics": {
    "per_building": {
      "Commercial": {
        "MAE": 129.20828247070312,
        "RMSE": 191.70082092285156,
        "MAPE": 0.1757652759552002,
        "sMAPE": 0.17045184969902039,
        "MASE": 2.137367169324905,
        "R2": 0.49050360918045044,
        "NRMSE": 0.11520274126534452
      },
      "Office": {
        "MAE": 70.4913558959961,
        "RMSE": 133.82403564453125,
        "MAPE": 0.18305425345897675,
        "sMAPE": 0.1674814075231552,
        "MASE": 0.6478466844307027,
        "R2": 0.7889271378517151,
        "NRMSE": 0.10646303551673131
      },
      "Public": {
        "MAE": 48.47207260131836,
        "RMSE": 73.05413818359375,
        "MAPE": 0.21872375905513763,
        "sMAPE": 0.20748980343341827,
        "MASE": 1.3758130906126933,
        "R2": 0.7274900674819946,
        "NRMSE": 0.1132271184151066
      },
      "Residential": {
        "MAE": 54.95962142944336,
        "RMSE": 82.48458099365234,
        "MAPE": 0.18015389144420624,
        "sMAPE": 0.16966180503368378,
        "MASE": 2.148695294888783,
        "R2": 0.2503352165222168,
        "NRMSE": 0.1558076637509526
      }
    },
    "avg": {
      "MAE": 75.78283309936523,
      "RMSE": 120.26589393615723,
      "MAPE": 0.1894242949783802,
      "sMAPE": 0.1787712164223194,
      "MASE": 1.577430559814271,
      "R2": 0.5643140077590942,
      "NRMSE": 0.12267513973703376
    },
    "total": {
      "MAE": 258.0083312988281,
      "RMSE": 355.2920227050781,
      "MAPE": 0.15725548565387726,
      "sMAPE": 0.15298296511173248,
      "R2": 0.5842893123626709,
      "NRMSE": 0.12511164417950071
    }
  },
  "micro_batch": 256,
  "effective_batch": 32,
  "accum_steps": 1,
  "clip_nonneg": true,
  "exports": {
    "test": {
      "npz": "C:\\Users\\13470\\Desktop\\C_school\\TransformerRuns\\MultiBuildingMSPatchTST\\20260119_105105_46578b6b\\1_hour\\Joint_Commercial-Office-Public-Residential\\preds\\test_samples.npz",
      "plots_dir": "C:\\Users\\13470\\Desktop\\C_school\\TransformerRuns\\MultiBuildingMSPatchTST\\20260119_105105_46578b6b\\1_hour\\Joint_Commercial-Office-Public-Residential\\preds\\plots",
      "export_k": 64,
      "plot_k": 12,
      "strategy": "uniform"
    }
  },
  "explain": {
    "dir": "C:\\Users\\13470\\Desktop\\C_school\\TransformerRuns\\MultiBuildingMSPatchTST\\20260119_105105_46578b6b\\1_hour\\Joint_Commercial-Office-Public-Residential\\explain"
  },
  "timestamp": "2026-01-19 10:52:38"
}