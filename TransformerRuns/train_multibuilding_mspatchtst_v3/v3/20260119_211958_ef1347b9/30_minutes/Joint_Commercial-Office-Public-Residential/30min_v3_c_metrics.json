{
  "model": "MultiBuildingMSPatchTST",
  "resolution": "30_minutes",
  "buildings": [
    "Commercial",
    "Office",
    "Public",
    "Residential"
  ],
  "series_dir": "C:\\Users\\13470\\Desktop\\C_school\\AfterWash\\30_minutes",
  "window": {
    "input_len": 336,
    "pred_len": 48
  },
  "patch_scales": [
    [
      24,
      12
    ],
    [
      48,
      24
    ]
  ],
  "model_cfg": {
    "d_model": 192,
    "n_heads": 8,
    "n_layers": 4,
    "d_ff": 384
  },
  "train_cfg": {
    "epochs": 30,
    "micro_batch": 32,
    "effective_batch": 32,
    "lr": 0.001,
    "weight_decay": 0.0001,
    "dropout": 0.1,
    "d_model": 256,
    "n_heads": 8,
    "n_layers": 6,
    "d_ff": 512,
    "huber_beta": 1.0,
    "total_loss_weight": 0.1,
    "residual_reg": 0.001,
    "fusion": "gated_residual",
    "gate_mode": "building",
    "gate_init": -2.0,
    "gate_max": 0.7,
    "gate_reg": 0.01,
    "grad_clip": 1.0,
    "patience": 6,
    "num_workers": 2,
    "save_every": 1,
    "grad_checkpoint": false,
    "auto_res_tune": true,
    "auto_quantiles": true
  },
  "best_val_loss_scaled": 18.512475193557094,
  "val_metrics": {
    "per_building": {
      "Commercial": {
        "MAE": 82.60130310058594,
        "RMSE": 111.6906967163086,
        "MAPE": 0.15413331985473633,
        "sMAPE": 0.16964003443717957,
        "MASE": 1.3451508917307966,
        "R2": 0.6779357194900513,
        "NRMSE": 0.09773424216322087
      },
      "Office": {
        "MAE": 96.76473999023438,
        "RMSE": 179.9518585205078,
        "MAPE": 0.23112767934799194,
        "sMAPE": 0.216085746884346,
        "MASE": 0.9053365120745698,
        "R2": 0.7204831838607788,
        "NRMSE": 0.15286431021456462
      },
      "Public": {
        "MAE": 46.33024978637695,
        "RMSE": 65.74996948242188,
        "MAPE": 0.2630882263183594,
        "sMAPE": 0.2649554908275604,
        "MASE": 1.3256479742964902,
        "R2": 0.61556476354599,
        "NRMSE": 0.12059788703279475
      },
      "Residential": {
        "MAE": 33.07838439941406,
        "RMSE": 44.43878936767578,
        "MAPE": 0.13544093072414398,
        "sMAPE": 0.14544017612934113,
        "MASE": 1.2911523832447245,
        "R2": 0.7508757710456848,
        "NRMSE": 0.06994599369195485
      }
    },
    "avg": {
      "MAE": 64.69366931915283,
      "RMSE": 100.45782852172852,
      "MAPE": 0.1959475390613079,
      "sMAPE": 0.19903036206960678,
      "MASE": 1.2168219403366454,
      "R2": 0.6912148594856262,
      "NRMSE": 0.11028560827563377
    },
    "total": {
      "MAE": 184.7798614501953,
      "RMSE": 257.5231018066406,
      "MAPE": 0.12843869626522064,
      "sMAPE": 0.13478602468967438,
      "R2": 0.7551648020744324,
      "NRMSE": 0.11085847547957607
    }
  },
  "test_metrics": {
    "per_building": {
      "Commercial": {
        "MAE": 102.03643035888672,
        "RMSE": 137.12579345703125,
        "MAPE": 0.14081482589244843,
        "sMAPE": 0.1419500857591629,
        "MASE": 1.6616492734884005,
        "R2": 0.745409369468689,
        "NRMSE": 0.08223633952718741
      },
      "Office": {
        "MAE": 80.19305419921875,
        "RMSE": 128.70301818847656,
        "MAPE": 0.2399531602859497,
        "sMAPE": 0.23542551696300507,
        "MASE": 0.750290859962572,
        "R2": 0.8053036332130432,
        "NRMSE": 0.09923438044721468
      },
      "Public": {
        "MAE": 52.45802688598633,
        "RMSE": 70.19261932373047,
        "MAPE": 0.28146877884864807,
        "sMAPE": 0.2869352698326111,
        "MASE": 1.5009821314938505,
        "R2": 0.7417076826095581,
        "NRMSE": 0.10879204066311504
      },
      "Residential": {
        "MAE": 47.22629928588867,
        "RMSE": 69.67172241210938,
        "MAPE": 0.16129103302955627,
        "sMAPE": 0.15754105150699615,
        "MASE": 1.8433895724328029,
        "R2": 0.4593505263328552,
        "NRMSE": 0.12737060770038278
      }
    },
    "avg": {
      "MAE": 70.47845268249512,
      "RMSE": 101.42328834533691,
      "MAPE": 0.20588194951415062,
      "sMAPE": 0.2054629810154438,
      "MASE": 1.4390779593444065,
      "R2": 0.6879428029060364,
      "NRMSE": 0.10440834208447497
    },
    "total": {
      "MAE": 199.8589630126953,
      "RMSE": 265.8093566894531,
      "MAPE": 0.12536540627479553,
      "sMAPE": 0.12517717480659485,
      "R2": 0.7699868083000183,
      "NRMSE": 0.09336308632599741
    }
  },
  "baseline_mode": "weekly",
  "fusion": "gated_residual",
  "gate_mode": "building",
  "gate_max": 0.7,
  "gate_reg": 0.01,
  "residual_reg": 0.001,
  "total_loss_weight": 0.1,
  "huber_beta": 1.0,
  "baseline_val_metrics": {
    "per_building": {
      "Commercial": {
        "MAE": 109.87394714355469,
        "RMSE": 150.3970184326172,
        "MAPE": 0.19903114438056946,
        "sMAPE": 0.19414891302585602,
        "MASE": 1.7892821593644639,
        "R2": 0.4160346984863281,
        "NRMSE": 0.13160396570409721
      },
      "Office": {
        "MAE": 98.60013580322266,
        "RMSE": 202.760986328125,
        "MAPE": 0.2233591079711914,
        "sMAPE": 0.18128985166549683,
        "MASE": 0.9225085816091417,
        "R2": 0.6451342105865479,
        "NRMSE": 0.17224005669239215
      },
      "Public": {
        "MAE": 54.8112678527832,
        "RMSE": 84.65929412841797,
        "MAPE": 0.28761252760887146,
        "sMAPE": 0.2613063454627991,
        "MASE": 1.5683154425605885,
        "R2": 0.3626450300216675,
        "NRMSE": 0.15528116697156258
      },
      "Residential": {
        "MAE": 39.23930740356445,
        "RMSE": 55.44549560546875,
        "MAPE": 0.1515941321849823,
        "sMAPE": 0.15449701249599457,
        "MASE": 1.5316323995521997,
        "R2": 0.6121854782104492,
        "NRMSE": 0.08727038564845277
      }
    },
    "avg": {
      "MAE": 75.63116455078125,
      "RMSE": 123.31569862365723,
      "MAPE": 0.21539922803640366,
      "sMAPE": 0.19781053066253662,
      "MASE": 1.4529346457715984,
      "R2": 0.5089998543262482,
      "NRMSE": 0.13659889375412618
    },
    "total": {
      "MAE": 262.0980224609375,
      "RMSE": 380.8123779296875,
      "MAPE": 0.18239788711071014,
      "sMAPE": 0.17431163787841797,
      "R2": 0.4646182060241699,
      "NRMSE": 0.16393200984638306
    }
  },
  "baseline_test_metrics": {
    "per_building": {
      "Commercial": {
        "MAE": 121.20899200439453,
        "RMSE": 175.35386657714844,
        "MAPE": 0.16380932927131653,
        "sMAPE": 0.1603318154811859,
        "MASE": 1.9738718102541137,
        "R2": 0.5836727619171143,
        "NRMSE": 0.10516227287145792
      },
      "Office": {
        "MAE": 70.33576202392578,
        "RMSE": 133.5695037841797,
        "MAPE": 0.18307894468307495,
        "sMAPE": 0.16800659894943237,
        "MASE": 0.6580654634247389,
        "R2": 0.7903016805648804,
        "NRMSE": 0.10298660545205246
      },
      "Public": {
        "MAE": 51.03562545776367,
        "RMSE": 77.55400085449219,
        "MAPE": 0.2256796807050705,
        "sMAPE": 0.21402768790721893,
        "MASE": 1.4602829429366102,
        "R2": 0.6846904754638672,
        "NRMSE": 0.12020149833184435
      },
      "Residential": {
        "MAE": 54.538299560546875,
        "RMSE": 82.06520080566406,
        "MAPE": 0.17881210148334503,
        "sMAPE": 0.16862158477306366,
        "MASE": 2.1287997202475872,
        "R2": 0.24989724159240723,
        "NRMSE": 0.1500277894070641
      }
    },
    "avg": {
      "MAE": 74.27966976165771,
      "RMSE": 117.1356430053711,
      "MAPE": 0.18784501403570175,
      "sMAPE": 0.17774692177772522,
      "MASE": 1.5552549842157624,
      "R2": 0.5771405398845673,
      "NRMSE": 0.1195945415156047
    },
    "total": {
      "MAE": 254.15159606933594,
      "RMSE": 348.0463562011719,
      "MAPE": 0.15460485219955444,
      "sMAPE": 0.15090817213058472,
      "R2": 0.6056458950042725,
      "NRMSE": 0.12224807434985296
    }
  },
  "micro_batch": 32,
  "effective_batch": 32,
  "accum_steps": 1,
  "clip_nonneg": false,
  "exports": {},
  "explain": {},
  "timestamp": "2026-01-19 21:31:04"
}