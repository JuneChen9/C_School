{
  "model": "MultiBuildingMSPatchTST",
  "resolution": "5_minutes",
  "buildings": [
    "Commercial",
    "Office",
    "Public",
    "Residential"
  ],
  "series_dir": "C:\\Users\\13470\\Desktop\\C_school\\AfterWash\\5_minutes",
  "window": {
    "input_len": 2016,
    "pred_len": 288
  },
  "patch_scales": [
    [
      32,
      16
    ],
    [
      64,
      32
    ]
  ],
  "model_cfg": {
    "d_model": 256,
    "n_heads": 8,
    "n_layers": 6,
    "d_ff": 512
  },
  "train_cfg": {
    "epochs": 30,
    "micro_batch": 32,
    "effective_batch": 32,
    "lr": 0.001,
    "weight_decay": 0.0001,
    "dropout": 0.1,
    "d_model": 256,
    "n_heads": 8,
    "n_layers": 6,
    "d_ff": 512,
    "huber_beta": 1.0,
    "total_loss_weight": 0.1,
    "residual_reg": 0.001,
    "fusion": "gated_residual",
    "gate_mode": "building",
    "gate_init": -2.0,
    "gate_max": 0.7,
    "gate_reg": 0.01,
    "grad_clip": 1.0,
    "patience": 6,
    "num_workers": 2,
    "save_every": 1,
    "grad_checkpoint": false,
    "auto_res_tune": true,
    "auto_quantiles": true
  },
  "best_val_loss_scaled": 22.797168060459875,
  "val_metrics": {
    "per_building": {
      "Commercial": {
        "MAE": 95.19981384277344,
        "RMSE": 129.5795135498047,
        "MAPE": 0.16667452454566956,
        "sMAPE": 0.17931406199932098,
        "MASE": 1.5169409363361672,
        "R2": 0.5658677816390991,
        "NRMSE": 0.11338773889857717
      },
      "Office": {
        "MAE": 105.40660858154297,
        "RMSE": 186.59249877929688,
        "MAPE": 0.25454533100128174,
        "sMAPE": 0.23671212792396545,
        "MASE": 0.9846998586795476,
        "R2": 0.699288010597229,
        "NRMSE": 0.1532864207811545
      },
      "Public": {
        "MAE": 50.73251724243164,
        "RMSE": 75.36985778808594,
        "MAPE": 0.2701745629310608,
        "sMAPE": 0.2731810212135315,
        "MASE": 1.4427141834011377,
        "R2": 0.48262345790863037,
        "NRMSE": 0.1312149278979744
      },
      "Residential": {
        "MAE": 39.706085205078125,
        "RMSE": 56.069339752197266,
        "MAPE": 0.1531032770872116,
        "sMAPE": 0.16956780850887299,
        "MASE": 1.554358042371578,
        "R2": 0.6000819206237793,
        "NRMSE": 0.08288150739423099
      }
    },
    "avg": {
      "MAE": 72.76125621795654,
      "RMSE": 111.90280246734619,
      "MAPE": 0.21112442389130592,
      "sMAPE": 0.21469375491142273,
      "MASE": 1.3746782551971075,
      "R2": 0.5869652926921844,
      "NRMSE": 0.12019264874298427
    },
    "total": {
      "MAE": 227.267822265625,
      "RMSE": 313.7534484863281,
      "MAPE": 0.15262490510940552,
      "sMAPE": 0.16045403480529785,
      "R2": 0.6368950009346008,
      "NRMSE": 0.13000043548129636
    }
  },
  "test_metrics": {
    "per_building": {
      "Commercial": {
        "MAE": 105.06002807617188,
        "RMSE": 152.1542205810547,
        "MAPE": 0.2101326882839203,
        "sMAPE": 0.14260593056678772,
        "MASE": 1.6740563970490354,
        "R2": 0.6879227161407471,
        "NRMSE": 0.07917070661806763
      },
      "Office": {
        "MAE": 78.49911499023438,
        "RMSE": 127.16693878173828,
        "MAPE": 0.22723479568958282,
        "sMAPE": 0.21862395107746124,
        "MASE": 0.7333322689872452,
        "R2": 0.8069724440574646,
        "NRMSE": 0.09574669002327879
      },
      "Public": {
        "MAE": 48.57547378540039,
        "RMSE": 68.6492691040039,
        "MAPE": 0.23226623237133026,
        "sMAPE": 0.2309093326330185,
        "MASE": 1.3813729104104728,
        "R2": 0.7553889751434326,
        "NRMSE": 0.10101423126864577
      },
      "Residential": {
        "MAE": 45.963714599609375,
        "RMSE": 71.0458755493164,
        "MAPE": 0.1485486775636673,
        "sMAPE": 0.14648298919200897,
        "MASE": 1.7993229268554924,
        "R2": 0.4384434223175049,
        "NRMSE": 0.12198810537618678
      }
    },
    "avg": {
      "MAE": 69.524582862854,
      "RMSE": 104.75407600402832,
      "MAPE": 0.20454559847712517,
      "sMAPE": 0.1846555508673191,
      "MASE": 1.3970211258255616,
      "R2": 0.6721818894147873,
      "NRMSE": 0.09947993332154474
    },
    "total": {
      "MAE": 191.4971160888672,
      "RMSE": 275.5716857910156,
      "MAPE": 0.1154976561665535,
      "sMAPE": 0.11676348000764847,
      "R2": 0.7518290877342224,
      "NRMSE": 0.09552605733213948
    }
  },
  "baseline_mode": "weekly",
  "fusion": "gated_residual",
  "gate_mode": "building",
  "gate_max": 0.7,
  "gate_reg": 0.01,
  "residual_reg": 0.001,
  "total_loss_weight": 0.1,
  "huber_beta": 1.0,
  "baseline_val_metrics": {
    "per_building": {
      "Commercial": {
        "MAE": 108.2773666381836,
        "RMSE": 148.58396911621094,
        "MAPE": 0.1966618001461029,
        "sMAPE": 0.19177857041358948,
        "MASE": 1.7253223856446527,
        "R2": 0.4291878342628479,
        "NRMSE": 0.1300174682951538
      },
      "Office": {
        "MAE": 100.67927551269531,
        "RMSE": 206.70138549804688,
        "MAPE": 0.22917819023132324,
        "sMAPE": 0.1852828413248062,
        "MASE": 0.9405375023769604,
        "R2": 0.6309806704521179,
        "NRMSE": 0.16980594483049366
      },
      "Public": {
        "MAE": 54.4230842590332,
        "RMSE": 84.69024658203125,
        "MAPE": 0.2869228720664978,
        "sMAPE": 0.25967371463775635,
        "MASE": 1.547665281218737,
        "R2": 0.3467519283294678,
        "NRMSE": 0.14744123081892727
      },
      "Residential": {
        "MAE": 39.08098220825195,
        "RMSE": 55.3955078125,
        "MAPE": 0.15102237462997437,
        "sMAPE": 0.15389877557754517,
        "MASE": 1.5298873884300235,
        "R2": 0.6096364259719849,
        "NRMSE": 0.08188545131189948
      }
    },
    "avg": {
      "MAE": 75.61517715454102,
      "RMSE": 123.84277725219727,
      "MAPE": 0.21594630926847458,
      "sMAPE": 0.1976584754884243,
      "MASE": 1.4358531394175935,
      "R2": 0.5041392147541046,
      "NRMSE": 0.13228752381411854
    },
    "total": {
      "MAE": 262.6336975097656,
      "RMSE": 382.3007507324219,
      "MAPE": 0.18317990005016327,
      "sMAPE": 0.17478585243225098,
      "R2": 0.4609047770500183,
      "NRMSE": 0.15840228791049296
    }
  },
  "baseline_test_metrics": {
    "per_building": {
      "Commercial": {
        "MAE": 124.09662628173828,
        "RMSE": 178.041015625,
        "MAPE": 0.2538420259952545,
        "sMAPE": 0.16541126370429993,
        "MASE": 1.9773909724117515,
        "R2": 0.5726985931396484,
        "NRMSE": 0.09264043389792613
      },
      "Office": {
        "MAE": 71.02643585205078,
        "RMSE": 133.6939697265625,
        "MAPE": 0.18415099382400513,
        "sMAPE": 0.1690668910741806,
        "MASE": 0.6635231157439309,
        "R2": 0.7866491079330444,
        "NRMSE": 0.10066103029625686
      },
      "Public": {
        "MAE": 50.070987701416016,
        "RMSE": 73.9654541015625,
        "MAPE": 0.22648246586322784,
        "sMAPE": 0.21499000489711761,
        "MASE": 1.4239018298370245,
        "R2": 0.7160367965698242,
        "NRMSE": 0.10883675214642403
      },
      "Residential": {
        "MAE": 54.292823791503906,
        "RMSE": 82.08903503417969,
        "MAPE": 0.17799660563468933,
        "sMAPE": 0.16754156351089478,
        "MASE": 2.12537919232073,
        "R2": 0.2503024935722351,
        "NRMSE": 0.14094957347703982
      }
    },
    "avg": {
      "MAE": 74.87171840667725,
      "RMSE": 116.94736862182617,
      "MAPE": 0.2106180228292942,
      "sMAPE": 0.17925243079662323,
      "MASE": 1.5475487775783594,
      "R2": 0.581421747803688,
      "NRMSE": 0.11077194745441171
    },
    "total": {
      "MAE": 255.00076293945312,
      "RMSE": 346.7999572753906,
      "MAPE": 0.15557214617729187,
      "sMAPE": 0.15167365968227386,
      "R2": 0.6069573163986206,
      "NRMSE": 0.12021711340328332
    }
  },
  "micro_batch": 32,
  "effective_batch": 32,
  "accum_steps": 1,
  "clip_nonneg": false,
  "exports": {},
  "explain": {},
  "timestamp": "2026-01-19 21:57:05"
}