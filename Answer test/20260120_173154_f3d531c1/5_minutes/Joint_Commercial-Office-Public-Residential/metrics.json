{
  "model": "MultiBuildingMSPatchTST",
  "resolution": "5_minutes",
  "buildings": [
    "Commercial",
    "Office",
    "Public",
    "Residential"
  ],
  "series_dir": "C:\\Users\\13470\\Desktop\\C_school\\AfterWash\\5_minutes",
  "paper_figs_dir": "C:\\Users\\13470\\Desktop\\C_school\\TransformerRuns\\MultiBuildingMSPatchTST\\20260120_173154_f3d531c1\\5_minutes\\Joint_Commercial-Office-Public-Residential\\paper_figs",
  "window": {
    "input_len": 2016,
    "pred_len": 288
  },
  "patch_scales": [
    [
      32,
      16
    ],
    [
      64,
      32
    ]
  ],
  "model_cfg": {
    "d_model": 256,
    "n_heads": 8,
    "n_layers": 6,
    "d_ff": 512
  },
  "train_cfg": {
    "epochs": 30,
    "micro_batch": 32,
    "effective_batch": 32,
    "lr": 0.001,
    "weight_decay": 0.0001,
    "dropout": 0.1,
    "d_model": 256,
    "n_heads": 8,
    "n_layers": 6,
    "d_ff": 512,
    "huber_beta": 1.0,
    "total_loss_weight": 0.1,
    "residual_reg": 0.001,
    "fusion": "gated_residual",
    "gate_mode": "building",
    "gate_init": -2.0,
    "gate_max": 0.7,
    "gate_reg": 0.01,
    "grad_clip": 1.0,
    "patience": 6,
    "num_workers": 2,
    "save_every": 1,
    "grad_checkpoint": false,
    "auto_res_tune": true,
    "auto_quantiles": true
  },
  "best_val_loss_scaled": 21.359079214998268,
  "val_metrics": {
    "per_building": {
      "Commercial": {
        "MAE": 89.02230834960938,
        "RMSE": 124.28433990478516,
        "MAPE": 0.15580236911773682,
        "sMAPE": 0.16167345643043518,
        "MASE": 1.4185068051255898,
        "R2": 0.6006238460540771,
        "NRMSE": 0.10875423048172908
      },
      "Office": {
        "MAE": 109.80903625488281,
        "RMSE": 186.92962646484375,
        "MAPE": 0.2783375680446625,
        "sMAPE": 0.25084373354911804,
        "MASE": 1.0258269755284977,
        "R2": 0.6982004046440125,
        "NRMSE": 0.15356337240890905
      },
      "Public": {
        "MAE": 49.597381591796875,
        "RMSE": 74.63566589355469,
        "MAPE": 0.2660580277442932,
        "sMAPE": 0.25976160168647766,
        "MASE": 1.4104335793177798,
        "R2": 0.49265408515930176,
        "NRMSE": 0.12993673872087574
      },
      "Residential": {
        "MAE": 36.688697814941406,
        "RMSE": 52.72146224975586,
        "MAPE": 0.14264196157455444,
        "sMAPE": 0.15282483398914337,
        "MASE": 1.4362375998100492,
        "R2": 0.6464139819145203,
        "NRMSE": 0.07793268625241073
      }
    },
    "avg": {
      "MAE": 71.27935600280762,
      "RMSE": 109.64277362823486,
      "MAPE": 0.21070998162031174,
      "sMAPE": 0.20627590641379356,
      "MASE": 1.322751239945479,
      "R2": 0.6094730794429779,
      "NRMSE": 0.11754675696598114
    },
    "total": {
      "MAE": 212.86599731445312,
      "RMSE": 303.6990051269531,
      "MAPE": 0.1457252949476242,
      "sMAPE": 0.14766186475753784,
      "R2": 0.6597939729690552,
      "NRMSE": 0.12583448281512913
    }
  },
  "test_metrics": {
    "per_building": {
      "Commercial": {
        "MAE": 109.004638671875,
        "RMSE": 153.45481872558594,
        "MAPE": 0.22338315844535828,
        "sMAPE": 0.15126575529575348,
        "MASE": 1.736910945277563,
        "R2": 0.6825646758079529,
        "NRMSE": 0.07984744942372535
      },
      "Office": {
        "MAE": 92.17082214355469,
        "RMSE": 134.79595947265625,
        "MAPE": 0.30384740233421326,
        "sMAPE": 0.27915775775909424,
        "MASE": 0.8610522315488716,
        "R2": 0.783117413520813,
        "NRMSE": 0.10149074178918793
      },
      "Public": {
        "MAE": 53.8078727722168,
        "RMSE": 71.40592193603516,
        "MAPE": 0.2904834449291229,
        "sMAPE": 0.2683483064174652,
        "MASE": 1.530170104829599,
        "R2": 0.7353495359420776,
        "NRMSE": 0.10507051868927805
      },
      "Residential": {
        "MAE": 51.630008697509766,
        "RMSE": 73.68950653076172,
        "MAPE": 0.1772090047597885,
        "sMAPE": 0.16866463422775269,
        "MASE": 2.021139047886424,
        "R2": 0.39587467908859253,
        "NRMSE": 0.1265273067337159
      }
    },
    "avg": {
      "MAE": 76.65333557128906,
      "RMSE": 108.33655166625977,
      "MAPE": 0.24873075261712074,
      "sMAPE": 0.2168591134250164,
      "MASE": 1.5373180823856143,
      "R2": 0.649226576089859,
      "NRMSE": 0.10323400415897682
    },
    "total": {
      "MAE": 222.2027587890625,
      "RMSE": 294.31591796875,
      "MAPE": 0.1488434076309204,
      "sMAPE": 0.14283113181591034,
      "R2": 0.716920018196106,
      "NRMSE": 0.10202368640646713
    }
  },
  "baseline_mode": "weekly",
  "fusion": "gated_residual",
  "gate_mode": "building",
  "gate_max": 0.7,
  "gate_reg": 0.01,
  "residual_reg": 0.001,
  "total_loss_weight": 0.1,
  "huber_beta": 1.0,
  "baseline_val_metrics": {
    "per_building": {
      "Commercial": {
        "MAE": 108.2773666381836,
        "RMSE": 148.58396911621094,
        "MAPE": 0.1966618001461029,
        "sMAPE": 0.19177857041358948,
        "MASE": 1.7253223856446527,
        "R2": 0.4291878342628479,
        "NRMSE": 0.1300174682951538
      },
      "Office": {
        "MAE": 100.67927551269531,
        "RMSE": 206.70138549804688,
        "MAPE": 0.22917819023132324,
        "sMAPE": 0.1852828413248062,
        "MASE": 0.9405375023769604,
        "R2": 0.6309806704521179,
        "NRMSE": 0.16980594483049366
      },
      "Public": {
        "MAE": 54.4230842590332,
        "RMSE": 84.69024658203125,
        "MAPE": 0.2869228720664978,
        "sMAPE": 0.25967371463775635,
        "MASE": 1.547665281218737,
        "R2": 0.3467519283294678,
        "NRMSE": 0.14744123081892727
      },
      "Residential": {
        "MAE": 39.08098220825195,
        "RMSE": 55.3955078125,
        "MAPE": 0.15102237462997437,
        "sMAPE": 0.15389877557754517,
        "MASE": 1.5298873884300235,
        "R2": 0.6096364259719849,
        "NRMSE": 0.08188545131189948
      }
    },
    "avg": {
      "MAE": 75.61517715454102,
      "RMSE": 123.84277725219727,
      "MAPE": 0.21594630926847458,
      "sMAPE": 0.1976584754884243,
      "MASE": 1.4358531394175935,
      "R2": 0.5041392147541046,
      "NRMSE": 0.13228752381411854
    },
    "total": {
      "MAE": 262.6336975097656,
      "RMSE": 382.3007507324219,
      "MAPE": 0.18317990005016327,
      "sMAPE": 0.17478585243225098,
      "R2": 0.4609047770500183,
      "NRMSE": 0.15840228791049296
    }
  },
  "baseline_test_metrics": {
    "per_building": {
      "Commercial": {
        "MAE": 124.09662628173828,
        "RMSE": 178.041015625,
        "MAPE": 0.2538420259952545,
        "sMAPE": 0.16541126370429993,
        "MASE": 1.9773909724117515,
        "R2": 0.5726985931396484,
        "NRMSE": 0.09264043389792613
      },
      "Office": {
        "MAE": 71.02643585205078,
        "RMSE": 133.6939697265625,
        "MAPE": 0.18415099382400513,
        "sMAPE": 0.1690668910741806,
        "MASE": 0.6635231157439309,
        "R2": 0.7866491079330444,
        "NRMSE": 0.10066103029625686
      },
      "Public": {
        "MAE": 50.070987701416016,
        "RMSE": 73.9654541015625,
        "MAPE": 0.22648246586322784,
        "sMAPE": 0.21499000489711761,
        "MASE": 1.4239018298370245,
        "R2": 0.7160367965698242,
        "NRMSE": 0.10883675214642403
      },
      "Residential": {
        "MAE": 54.292823791503906,
        "RMSE": 82.08903503417969,
        "MAPE": 0.17799660563468933,
        "sMAPE": 0.16754156351089478,
        "MASE": 2.12537919232073,
        "R2": 0.2503024935722351,
        "NRMSE": 0.14094957347703982
      }
    },
    "avg": {
      "MAE": 74.87171840667725,
      "RMSE": 116.94736862182617,
      "MAPE": 0.2106180228292942,
      "sMAPE": 0.17925243079662323,
      "MASE": 1.5475487775783594,
      "R2": 0.581421747803688,
      "NRMSE": 0.11077194745441171
    },
    "total": {
      "MAE": 255.00076293945312,
      "RMSE": 346.7999572753906,
      "MAPE": 0.15557214617729187,
      "sMAPE": 0.15167365968227386,
      "R2": 0.6069573163986206,
      "NRMSE": 0.12021711340328332
    }
  },
  "micro_batch": 32,
  "effective_batch": 32,
  "accum_steps": 1,
  "clip_nonneg": true,
  "exports": {
    "test": {
      "npz": "C:\\Users\\13470\\Desktop\\C_school\\TransformerRuns\\MultiBuildingMSPatchTST\\20260120_173154_f3d531c1\\5_minutes\\Joint_Commercial-Office-Public-Residential\\preds\\test\\test_samples.npz",
      "plots_dir": "C:\\Users\\13470\\Desktop\\C_school\\TransformerRuns\\MultiBuildingMSPatchTST\\20260120_173154_f3d531c1\\5_minutes\\Joint_Commercial-Office-Public-Residential\\preds\\test\\plots",
      "export_k": 64,
      "plot_k": 12,
      "strategy": "uniform"
    }
  },
  "explain": {
    "dir": "C:\\Users\\13470\\Desktop\\C_school\\TransformerRuns\\MultiBuildingMSPatchTST\\20260120_173154_f3d531c1\\5_minutes\\Joint_Commercial-Office-Public-Residential\\explain"
  },
  "timestamp": "2026-01-20 18:13:11"
}